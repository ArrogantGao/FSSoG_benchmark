<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - ../../.julia/packages/ChebParticleMesh/ElXWI/src/utils.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Tue, 20 Feb 2024 21:17:56
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    function horner&#40;x, p&#41;</span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Evaluate a polynomial using Horner&#39;s method.</span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@inline function horner&#40;x::T, p::AbstractArray&#123;T, 1&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>20 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              20 &#40;0 &#37;&#41;
              samples spent in horner
              <br />
              
              8 &#40;40 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L64'>line 64</a>
              <br />
              
              6 &#40;30 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L57'>line 57</a>
              <br />
              
              5 &#40;25 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L62'>line 62</a>
              <br />
              
              1 &#40;5 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L59'>line 59</a>
              <br />
            </div>
            <div class='callees'>
              16 &#40;80 &#37;&#41;
              samples spent calling
              <a href='subarray.jl-834e9e7ac651e795a58e5ee35116a1f1a5a34328.html#L315'>getindex</a>
              <br />
              4 &#40;20 &#37;&#41;
              samples spent calling
              <a href='subarray.jl-834e9e7ac651e795a58e5ee35116a1f1a5a34328.html#L314'>getindex</a>
              <br />
            </div>
            <span class='code'>    ex &#61; p&#91;end&#93;</span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>3 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              3 &#40;0 &#37;&#41;
              samples spent in horner
              <br />
              
              2 &#40;67 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L57'>line 57</a>
              <br />
              1 &#40;33 &#37;&#41; &#40;ex.&#41;,
              1 &#40;33 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L62'>line 62</a>
              <br />
            </div>
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='int.jl-7f9f75a92d8c6f74216e9bbdc4b48345bf2279eb.html#L86'>-</a>
              <br />
            </div>
            <span class='code'>    for i &#61; length&#40;p&#41;-1:-1:1</span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>192 &#40;2 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              192 &#40;2 &#37;&#41;
              samples spent in horner
              <br />
              
              71 &#40;37 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L64'>line 64</a>
              <br />
              
              68 &#40;35 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L59'>line 59</a>
              <br />
              
              28 &#40;15 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L62'>line 62</a>
              <br />
              
              25 &#40;13 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L57'>line 57</a>
              <br />
            </div>
            <div class='callees'>
              166 &#40;86 &#37;&#41;
              samples spent calling
              <a href='float.jl-f6ce64b5a75ccb10e4a371128ee71f3943191a06.html#L409'>&#43;</a>
              <br />
              15 &#40;8 &#37;&#41;
              samples spent calling
              <a href='subarray.jl-834e9e7ac651e795a58e5ee35116a1f1a5a34328.html#L315'>getindex</a>
              <br />
              11 &#40;6 &#37;&#41;
              samples spent calling
              <a href='subarray.jl-834e9e7ac651e795a58e5ee35116a1f1a5a34328.html#L314'>getindex</a>
              <br />
            </div>
            <span class='code'>        ex &#61; p&#91;i&#93; &#43; x * ex</span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'>27 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>56 &#40;1 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              56 &#40;1 &#37;&#41;
              samples spent in horner
              <br />
              2 &#40;4 &#37;&#41; &#40;ex.&#41;,
              24 &#40;43 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L64'>line 64</a>
              <br />
              12 &#40;21 &#37;&#41; &#40;ex.&#41;,
              15 &#40;27 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L59'>line 59</a>
              <br />
              7 &#40;12 &#37;&#41; &#40;ex.&#41;,
              9 &#40;16 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L62'>line 62</a>
              <br />
              6 &#40;11 &#37;&#41; &#40;ex.&#41;,
              8 &#40;14 &#37;&#41; &#40;incl.&#41;
              when called from pwcheb_eval&#33;
              <a href='chebpoly.jl-e2e581397c09a2cdd33ae9c7d82dc9fdc0817317.html#L57'>line 57</a>
              <br />
            </div>
            <div class='callees'>
              29 &#40;100 &#37;&#41;
              samples spent calling
              <a href='range.jl-13ae9c59d7e63dd2e1ef395b43a819c8535e26f3.html#L901'>iterate</a>
              <br />
            </div>
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return ex</span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function fft&#33;&#40;gridbox::GridBox&#123;N, T&#125;&#41; where&#123;N, T&#125;</span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    calculate the inplace fft on the padded grid</span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function FFTW.fft&#33;&#40;gridbox::GridBox&#123;N, T&#125;&#41; where&#123;N, T&#125;</span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>197 &#40;2 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              197 &#40;2 &#37;&#41;
              samples spent in fft&#33;
              <br />
              
              197 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from energy_mid
              <a href='energy_mid.jl-0df523ddfebcb5fedf65be9d47a55083f2260b03.html#L35'>line 35</a>
              <br />
            </div>
            <div class='callees'>
              197 &#40;100 &#37;&#41;
              samples spent calling
              <a href='definitions.jl-8d944121dc550b05b6566a476ce7299355899c14.html#L66'>fft&#33;</a>
              <br />
            </div>
            <span class='code'>    fft&#33;&#40;gridbox.pad_grid&#41;</span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L23'>
          <td class='lineno'>23</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return gridbox</span>
          </td>
        </tr>
        <tr id='L24'>
          <td class='lineno'>24</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L25'>
          <td class='lineno'>25</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L26'>
          <td class='lineno'>26</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L27'>
          <td class='lineno'>27</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function ifft&#33;&#40;gridbox::GridBox&#123;N, T&#125;&#41; where&#123;N, T&#125;</span>
          </td>
        </tr>
        <tr id='L28'>
          <td class='lineno'>28</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L29'>
          <td class='lineno'>29</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    calculate the inplace ifft on the padded grid</span>
          </td>
        </tr>
        <tr id='L30'>
          <td class='lineno'>30</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L31'>
          <td class='lineno'>31</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function FFTW.ifft&#33;&#40;gridbox::GridBox&#123;N, T&#125;&#41; where&#123;N, T&#125;</span>
          </td>
        </tr>
        <tr id='L32'>
          <td class='lineno'>32</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L33'>
          <td class='lineno'>33</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>188 &#40;2 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              188 &#40;2 &#37;&#41;
              samples spent in ifft&#33;
              <br />
              
              188 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from energy_mid
              <a href='energy_mid.jl-0df523ddfebcb5fedf65be9d47a55083f2260b03.html#L37'>line 37</a>
              <br />
            </div>
            <div class='callees'>
              188 &#40;100 &#37;&#41;
              samples spent calling
              <a href='definitions.jl-8d944121dc550b05b6566a476ce7299355899c14.html#L66'>ifft&#33;</a>
              <br />
            </div>
            <span class='code'>    ifft&#33;&#40;gridbox.pad_grid&#41;</span>
          </td>
        </tr>
        <tr id='L34'>
          <td class='lineno'>34</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L35'>
          <td class='lineno'>35</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return gridbox</span>
          </td>
        </tr>
        <tr id='L36'>
          <td class='lineno'>36</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L37'>
          <td class='lineno'>37</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L38'>
          <td class='lineno'>38</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function funcpack&#40;f::Function, args::Vector&#41;</span>
          </td>
        </tr>
        <tr id='L39'>
          <td class='lineno'>39</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    g &#61; x -&gt; f&#40;x, args...&#41;</span>
          </td>
        </tr>
        <tr id='L40'>
          <td class='lineno'>40</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return g</span>
          </td>
        </tr>
        <tr id='L41'>
          <td class='lineno'>41</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L42'>
          <td class='lineno'>42</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L43'>
          <td class='lineno'>43</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L44'>
          <td class='lineno'>44</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    function Wkb&#40;x::T, width::T, β::T&#41; where&#123;T&lt;:Real&#125;</span>
          </td>
        </tr>
        <tr id='L45'>
          <td class='lineno'>45</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L46'>
          <td class='lineno'>46</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    WKB kernel function, used as window function for the Chebyshev interpolation</span>
          </td>
        </tr>
        <tr id='L47'>
          <td class='lineno'>47</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L48'>
          <td class='lineno'>48</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function Wkb&#40;x::T, width::T, β::T&#41; where&#123;T&lt;:Real&#125;</span>
          </td>
        </tr>
        <tr id='L49'>
          <td class='lineno'>49</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return T&#40;besseli&#40;0, β * sqrt&#40;abs&#40;one&#40;T&#41; - &#40;x / width&#41;^2&#41;&#41;&#41; / besseli&#40;0, β&#41; * &#40;abs&#40;x&#41; &lt;&#61; width&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L50'>
          <td class='lineno'>50</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L51'>
          <td class='lineno'>51</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L52'>
          <td class='lineno'>52</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L53'>
          <td class='lineno'>53</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    function FWkb&#40;k::T, width::T, β::T&#41; where&#123;T&lt;:Real&#125;</span>
          </td>
        </tr>
        <tr id='L54'>
          <td class='lineno'>54</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L55'>
          <td class='lineno'>55</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Fourier transform of Wkb kernel function</span>
          </td>
        </tr>
        <tr id='L56'>
          <td class='lineno'>56</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L57'>
          <td class='lineno'>57</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function FWkb&#40;k::T, width::T, β::T&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L58'>
          <td class='lineno'>58</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return T&#40;2 * width * sinh&#40;sqrt&#40;β^2 - &#40;k * width&#41;^2&#41;&#41; / &#40;besseli&#40;0, β&#41; * sqrt&#40;β^2 - &#40;k * width&#41;^2&#41;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L59'>
          <td class='lineno'>59</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

