<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - ../../../.julia/packages/OMEinsum/zZBsQ/src/einsum.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Wed, 21 Feb 2024 12:22:23
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>## non-inplace einsum</span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@doc raw&quot;</span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    einsum&#40;code::EinCode, xs, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    einsum&#40;rule, ixs, iy, xs, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>return the tensor that results from contracting the tensors &#96;xs&#96; according</span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>to their indices &#96;ixs&#96; &#40;&#96;getixs&#40;code&#41;&#96;&#41;, where all indices that do not appear in the output &#96;iy&#96; &#40;&#96;getiy&#40;code&#41;&#96;&#41; are</span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>summed over.</span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>The result is permuted according to &#96;out&#96;.</span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;ixs&#96; - tuple of tuples of index-labels of the input-tensors &#96;xs&#96;</span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;iy&#96; - tuple of index-labels of the output-tensor</span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;xs&#96; - tuple of tensors</span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;size_dict&#96; - a dictionary that maps index-labels to their sizes</span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># example</span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;&#96;&#96;jldoctest; setup &#61; :&#40;using OMEinsum&#41;</span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>julia&gt; a, b &#61; rand&#40;2,2&#41;, rand&#40;2,2&#41;;</span>
          </td>
        </tr>
        <tr id='L23'>
          <td class='lineno'>23</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L24'>
          <td class='lineno'>24</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>julia&gt; einsum&#40;EinCode&#40;&#40;&#40;&#39;i&#39;,&#39;j&#39;&#41;,&#40;&#39;j&#39;,&#39;k&#39;&#41;&#41;,&#40;&#39;i&#39;,&#39;k&#39;&#41;&#41;, &#40;a, b&#41;&#41; ≈ a * b</span>
          </td>
        </tr>
        <tr id='L25'>
          <td class='lineno'>25</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>true</span>
          </td>
        </tr>
        <tr id='L26'>
          <td class='lineno'>26</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L27'>
          <td class='lineno'>27</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>julia&gt; einsum&#40;EinCode&#40;&#40;&#40;&#39;i&#39;,&#39;j&#39;&#41;,&#40;&#39;j&#39;,&#39;k&#39;&#41;&#41;,&#40;&#39;k&#39;,&#39;i&#39;&#41;&#41;, &#40;a, b&#41;&#41; ≈ permutedims&#40;a * b, &#40;2,1&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L28'>
          <td class='lineno'>28</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>true</span>
          </td>
        </tr>
        <tr id='L29'>
          <td class='lineno'>29</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;&#96;&#96;</span>
          </td>
        </tr>
        <tr id='L30'>
          <td class='lineno'>30</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;</span>
          </td>
        </tr>
        <tr id='L31'>
          <td class='lineno'>31</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function einsum&#40;code::AbstractEinsum, @nospecialize&#40;xs::Tuple&#41;, size_dict::Dict &#61; get_size_dict&#33;&#40;getixs&#40;code&#41;, xs, Dict&#123;labeltype&#40;code&#41;,Int&#125;&#40;&#41;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L32'>
          <td class='lineno'>32</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    y &#61; get_output_array&#40;xs, map&#40;y-&gt;size_dict&#91;y&#93;,getiyv&#40;code&#41;&#41;; fillzero&#61;false&#41;</span>
          </td>
        </tr>
        <tr id='L33'>
          <td class='lineno'>33</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    einsum&#33;&#40;code, xs, y, true, false, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L34'>
          <td class='lineno'>34</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L35'>
          <td class='lineno'>35</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L36'>
          <td class='lineno'>36</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># inplace einsum, EinCode as the input</span>
          </td>
        </tr>
        <tr id='L37'>
          <td class='lineno'>37</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function einsum&#33;&#40;code::EinCode, @nospecialize&#40;xs::Tuple&#41;, @nospecialize&#40;y&#41;, sx, sy, size_dict::Dict&#41;</span>
          </td>
        </tr>
        <tr id='L38'>
          <td class='lineno'>38</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>970 &#40;13 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              970 &#40;13 &#37;&#41;
              samples spent in einsum&#33;
              <br />
              
              311 &#40;32 &#37;&#41; &#40;incl.&#41;
              when called from interpolate_nu_einsum&#33;
              <a href='nugrid_interpolate.jl-8b49c6f82ba551cc1ba45bf83952282a76b7b918.html#L44'>line 44</a>
              <br />
              
              262 &#40;27 &#37;&#41; &#40;incl.&#41;
              when called from interpolate_nu_einsum&#33;
              <a href='nugrid_interpolate.jl-8b49c6f82ba551cc1ba45bf83952282a76b7b918.html#L48'>line 48</a>
              <br />
              
              167 &#40;17 &#37;&#41; &#40;incl.&#41;
              when called from interpolate_nu_einsum&#33;
              <a href='nugrid_interpolate.jl-8b49c6f82ba551cc1ba45bf83952282a76b7b918.html#L45'>line 45</a>
              <br />
              
              165 &#40;17 &#37;&#41; &#40;incl.&#41;
              when called from interpolate_nu_einsum&#33;
              <a href='nugrid_interpolate.jl-8b49c6f82ba551cc1ba45bf83952282a76b7b918.html#L50'>line 50</a>
              <br />
              
              65 &#40;7 &#37;&#41; &#40;incl.&#41;
              when called from interpolate_nu_einsum&#33;
              <a href='nugrid_interpolate.jl-8b49c6f82ba551cc1ba45bf83952282a76b7b918.html#L49'>line 49</a>
              <br />
            </div>
            <div class='callees'>
              969 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L98'>einsum&#33;</a>
              <br />
              1 &#40;0 &#37;&#41;
              samples spent calling
              <a href='logging.jl-b684d8cb49004825482e0d62366f76d1d4f01bc2.html#L326'>current_logger_for_env</a>
              <br />
            </div>
            <span class='code'>    einsum&#33;&#40;getixs&#40;code&#41;, getiy&#40;code&#41;, xs, y, sx, sy, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L39'>
          <td class='lineno'>39</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L40'>
          <td class='lineno'>40</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># inplace einsum, the fallback</span>
          </td>
        </tr>
        <tr id='L41'>
          <td class='lineno'>41</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function einsum&#33;&#40;ixs, iy, @nospecialize&#40;xs::Tuple&#41;, @nospecialize&#40;y&#41;, sx, sy, size_dict::Dict&#41;</span>
          </td>
        </tr>
        <tr id='L42'>
          <td class='lineno'>42</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    @debug &quot;fallback to loop_einsum&quot; ixs &#61;&gt; iy size.&#40;xs&#41;</span>
          </td>
        </tr>
        <tr id='L43'>
          <td class='lineno'>43</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    loop_einsum&#33;&#40;ixs, iy, &#40;xs...,&#41;, y, sx, sy, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L44'>
          <td class='lineno'>44</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L45'>
          <td class='lineno'>45</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L46'>
          <td class='lineno'>46</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>struct UnaryOperation&#123;LT&#125;</span>
          </td>
        </tr>
        <tr id='L47'>
          <td class='lineno'>47</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    type</span>
          </td>
        </tr>
        <tr id='L48'>
          <td class='lineno'>48</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ix::Vector&#123;LT&#125;</span>
          </td>
        </tr>
        <tr id='L49'>
          <td class='lineno'>49</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    iy::Vector&#123;LT&#125;</span>
          </td>
        </tr>
        <tr id='L50'>
          <td class='lineno'>50</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L51'>
          <td class='lineno'>51</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># for unary operations</span>
          </td>
        </tr>
        <tr id='L52'>
          <td class='lineno'>52</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># overhead ~ 2.3us</span>
          </td>
        </tr>
        <tr id='L53'>
          <td class='lineno'>53</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># @benchmark OMEinsum.einsum&#40;DefaultRule&#40;&#41;, &#36;&#40;&#40;&#40;&#39;a&#39;, &#39;a&#39;, &#39;b&#39;&#41;,&#41;&#41;, &#36;&#40;&#40;&#39;c&#39;, &#39;b&#39;,&#39;a&#39;&#41;&#41;, &#40;x,&#41;, &#36;&#40;Dict&#40;&#39;a&#39;&#61;&gt;1, &#39;b&#39;&#61;&gt;1, &#39;c&#39;&#61;&gt;1&#41;&#41;&#41; setup&#61;&#40;x&#61;randn&#40;1,1,1&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L54'>
          <td class='lineno'>54</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              5 &#40;0 &#37;&#41;
              samples spent in unary_pipeline
              <br />
              
              5 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from einsum&#33;
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L80'>line 80</a>
              <br />
            </div>
            
            <span class='code'>function unary_pipeline&#40;ix::Vector&#123;LT&#125;, iy::Vector&#123;LT&#125;&#41; where LT</span>
          </td>
        </tr>
        <tr id='L55'>
          <td class='lineno'>55</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='utils.jl-3159adf2e1c9c3eb040c5bd493a54451094bc6ca.html#L106'>_unique</a>
              <br />
            </div>
            <span class='code'>    ix_unique &#61; _unique&#40;LT, ix&#41;</span>
          </td>
        </tr>
        <tr id='L56'>
          <td class='lineno'>56</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='utils.jl-3159adf2e1c9c3eb040c5bd493a54451094bc6ca.html#L106'>_unique</a>
              <br />
            </div>
            <span class='code'>    iy_unique &#61; _unique&#40;LT, iy&#41;</span>
          </td>
        </tr>
        <tr id='L57'>
          <td class='lineno'>57</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    iy_a &#61; filter&#40;i-&gt;i ∈ ix, iy_unique&#41;</span>
          </td>
        </tr>
        <tr id='L58'>
          <td class='lineno'>58</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L59'>
          <td class='lineno'>59</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    operations &#61; UnaryOperation&#91;&#93;</span>
          </td>
        </tr>
        <tr id='L60'>
          <td class='lineno'>60</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if length&#40;ix_unique&#41; &#33;&#61; length&#40;ix&#41;  # diag</span>
          </td>
        </tr>
        <tr id='L61'>
          <td class='lineno'>61</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;operations, UnaryOperation&#40;Diag&#40;&#41;, ix, ix_unique&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L62'>
          <td class='lineno'>62</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L63'>
          <td class='lineno'>63</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if length&#40;ix_unique&#41; &#33;&#61; length&#40;iy_a&#41;  # sum</span>
          </td>
        </tr>
        <tr id='L64'>
          <td class='lineno'>64</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;operations, UnaryOperation&#40;Sum&#40;&#41;, ix_unique, iy_a&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L65'>
          <td class='lineno'>65</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    elseif ix_unique &#33;&#61; iy_a   # permute, high freq</span>
          </td>
        </tr>
        <tr id='L66'>
          <td class='lineno'>66</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L1120'>push&#33;</a>
              <br />
            </div>
            <span class='code'>        push&#33;&#40;operations, UnaryOperation&#40;Permutedims&#40;&#41;, ix_unique, iy_a&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L67'>
          <td class='lineno'>67</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L68'>
          <td class='lineno'>68</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L69'>
          <td class='lineno'>69</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if length&#40;iy_a&#41; &#33;&#61; length&#40;iy_unique&#41;  # repeat</span>
          </td>
        </tr>
        <tr id='L70'>
          <td class='lineno'>70</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;operations, UnaryOperation&#40;Repeat&#40;&#41;, iy_a, iy_unique&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L71'>
          <td class='lineno'>71</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L72'>
          <td class='lineno'>72</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if length&#40;iy_unique&#41; &#33;&#61; length&#40;iy&#41;  # duplicate</span>
          </td>
        </tr>
        <tr id='L73'>
          <td class='lineno'>73</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;operations, UnaryOperation&#40;Duplicate&#40;&#41;, iy_unique, iy&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L74'>
          <td class='lineno'>74</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L75'>
          <td class='lineno'>75</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return operations</span>
          </td>
        </tr>
        <tr id='L76'>
          <td class='lineno'>76</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L77'>
          <td class='lineno'>77</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L78'>
          <td class='lineno'>78</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              593 &#40;8 &#37;&#41;
              samples spent in einsum&#33;
              <br />
              1 &#40;0 &#37;&#41; &#40;ex.&#41;,
              583 &#40;98 &#37;&#41; &#40;incl.&#41;
              when called from simplifyto
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L124'>line 124</a>
              <br />
              
              10 &#40;2 &#37;&#41; &#40;incl.&#41;
              when called from einsum&#33;
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L113'>line 113</a>
              <br />
            </div>
            
            <span class='code'>function einsum&#33;&#40;ixs, iy, @nospecialize&#40;xs::NTuple&#123;1, Any&#125;&#41;, @nospecialize&#40;y&#41;, sx, sy, size_dict::Dict&#123;LT&#125;&#41; where LT</span>
          </td>
        </tr>
        <tr id='L79'>
          <td class='lineno'>79</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='logging.jl-b684d8cb49004825482e0d62366f76d1d4f01bc2.html#L389'>macro expansion</a>
              <br />
            </div>
            <span class='code'>    @debug &quot;compiling unary&quot; ixs&#91;1&#93; &#61;&gt; iy size&#40;xs&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L80'>
          <td class='lineno'>80</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>5 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              5 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L54'>unary_pipeline</a>
              <br />
            </div>
            <span class='code'>    pipeline &#61; unary_pipeline&#40;collect&#40;LT, ixs&#91;1&#93;&#41;, collect&#40;LT, iy&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L81'>
          <td class='lineno'>81</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='tuple.jl-c62560d788f21abd7064789060b6999579687d7b.html#L31'>getindex</a>
              <br />
            </div>
            <span class='code'>    lasttensor &#61; xs&#91;1&#93;</span>
          </td>
        </tr>
        <tr id='L82'>
          <td class='lineno'>82</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for &#40;k, op&#41; in enumerate&#40;pipeline&#41;</span>
          </td>
        </tr>
        <tr id='L83'>
          <td class='lineno'>83</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        if k &#61;&#61; length&#40;pipeline&#41;  # last operation</span>
          </td>
        </tr>
        <tr id='L84'>
          <td class='lineno'>84</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>586 &#40;8 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              585 &#40;100 &#37;&#41;
              samples spent calling
              <a href='unaryrules.jl-a30408916eb0e4eba6de57fd34306310ec02891c.html#L118'>unary_einsum&#33;</a>
              <br />
            </div>
            <span class='code'>            unary_einsum&#33;&#40;op.type, op.ix, op.iy, lasttensor, y, sx, sy&#41;</span>
          </td>
        </tr>
        <tr id='L85'>
          <td class='lineno'>85</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        else</span>
          </td>
        </tr>
        <tr id='L86'>
          <td class='lineno'>86</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            cache &#61; similar&#40;y, &#40;&#91;size_dict&#91;l&#93; for l in op.iy&#93;...,&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L87'>
          <td class='lineno'>87</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            unary_einsum&#33;&#40;op.type, op.ix, op.iy, lasttensor, cache, true, false&#41;</span>
          </td>
        </tr>
        <tr id='L88'>
          <td class='lineno'>88</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            lasttensor &#61; cache</span>
          </td>
        </tr>
        <tr id='L89'>
          <td class='lineno'>89</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L90'>
          <td class='lineno'>90</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L91'>
          <td class='lineno'>91</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if length&#40;pipeline&#41; &#61;&#61; 0</span>
          </td>
        </tr>
        <tr id='L92'>
          <td class='lineno'>92</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        @flatten_addmul&#33; sy * y &#43; sx * lasttensor</span>
          </td>
        </tr>
        <tr id='L93'>
          <td class='lineno'>93</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L94'>
          <td class='lineno'>94</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return y</span>
          </td>
        </tr>
        <tr id='L95'>
          <td class='lineno'>95</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L96'>
          <td class='lineno'>96</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L97'>
          <td class='lineno'>97</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># there are too many combination in the binary case, so nospecialize</span>
          </td>
        </tr>
        <tr id='L98'>
          <td class='lineno'>98</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              969 &#40;13 &#37;&#41;
              samples spent in einsum&#33;
              <br />
              15 &#40;2 &#37;&#41; &#40;ex.&#41;,
              969 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from einsum&#33;
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L38'>line 38</a>
              <br />
            </div>
            
            <span class='code'>function einsum&#33;&#40;ixs, iy, @nospecialize&#40;xs::NTuple&#123;2, Any&#125;&#41;, @nospecialize&#40;y&#41;, sx, sy, size_dict::Dict&#123;LT&#125;&#41; where LT</span>
          </td>
        </tr>
        <tr id='L99'>
          <td class='lineno'>99</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>4 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              4 &#40;100 &#37;&#41;
              samples spent calling
              <a href='utils.jl-3159adf2e1c9c3eb040c5bd493a54451094bc6ca.html#L54'>_collect</a>
              <br />
            </div>
            <span class='code'>    iyv &#61; _collect&#40;LT,iy&#41;</span>
          </td>
        </tr>
        <tr id='L100'>
          <td class='lineno'>100</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>6 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              6 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-9538a2221b315be425e9c47ec7c3883483af8540.html#L903'>materialize</a>
              <br />
            </div>
            <span class='code'>    ix1v, ix2v &#61; _collect.&#40;Ref&#40;LT&#41;, ixs&#41;</span>
          </td>
        </tr>
        <tr id='L101'>
          <td class='lineno'>101</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='logging.jl-b684d8cb49004825482e0d62366f76d1d4f01bc2.html#L389'>macro expansion</a>
              <br />
            </div>
            <span class='code'>    @debug &quot;compiling binary&quot; ixs &#61;&gt; iyv size.&#40;xs&#41;</span>
          </td>
        </tr>
        <tr id='L102'>
          <td class='lineno'>102</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    x1, x2 &#61; xs</span>
          </td>
        </tr>
        <tr id='L103'>
          <td class='lineno'>103</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>5 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              5 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L133'>analyze_binary</a>
              <br />
            </div>
            <span class='code'>    c1, c2, cy, s1, s2, s3, i1, i2, iyb &#61; analyze_binary&#40;ix1v, ix2v, iyv, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L104'>
          <td class='lineno'>104</td>
          <td class='tracecount excl'>9 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>9 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>    rule &#61; SimpleBinaryRule&#123;&#40;i1...,&#41;, &#40;i2...,&#41;, &#40;iyb...,&#41;&#125;&#40;&#41;</span>
          </td>
        </tr>
        <tr id='L105'>
          <td class='lineno'>105</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>218 &#40;3 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              218 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L121'>simplifyto</a>
              <br />
            </div>
            <span class='code'>    xs1 &#61; simplifyto&#40;ix1v, c1, x1, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L106'>
          <td class='lineno'>106</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>444 &#40;6 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              443 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L121'>simplifyto</a>
              <br />
            </div>
            <span class='code'>    xs2 &#61; simplifyto&#40;ix2v, c2, x2, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L107'>
          <td class='lineno'>107</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>3 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              3 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L119'>safe_reshape</a>
              <br />
            </div>
            <span class='code'>    x1_ &#61; safe_reshape&#40;xs1, s1&#41;</span>
          </td>
        </tr>
        <tr id='L108'>
          <td class='lineno'>108</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>3 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              3 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L119'>safe_reshape</a>
              <br />
            </div>
            <span class='code'>    x2_ &#61; safe_reshape&#40;xs2, s2&#41;</span>
          </td>
        </tr>
        <tr id='L109'>
          <td class='lineno'>109</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='logging.jl-b684d8cb49004825482e0d62366f76d1d4f01bc2.html#L389'>macro expansion</a>
              <br />
            </div>
            <span class='code'>    @debug rule size.&#40;&#40;x1_, x2_&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L110'>
          <td class='lineno'>110</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if cy &#33;&#61; iyv</span>
          </td>
        </tr>
        <tr id='L111'>
          <td class='lineno'>111</td>
          <td class='tracecount excl'>2 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>9 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              7 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L421'>similar</a>
              <br />
            </div>
            <span class='code'>        y_ &#61; similar&#40;y, &#40;s3...,&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L112'>
          <td class='lineno'>112</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>71 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              66 &#40;93 &#37;&#41;
              samples spent calling
              <a href='binaryrules.jl-9cc4c5013c534aa7acdfb0aa406bb357a4383a5e.html#L112'>binary_einsum&#33;</a>
              <br />
              4 &#40;6 &#37;&#41;
              samples spent calling
              <a href='binaryrules.jl-9cc4c5013c534aa7acdfb0aa406bb357a4383a5e.html#L84'>binary_einsum&#33;</a>
              <br />
              1 &#40;1 &#37;&#41;
              samples spent calling
              <a href='reshapedarray.jl-e699fe85bbcca1900e0dbbb16cec4bcbfba5babd.html#L117'>reshape</a>
              <br />
            </div>
            <span class='code'>        y_ &#61; reshape&#40;binary_einsum&#33;&#40;rule, x1_, x2_, y_, true, false&#41;, &#91;size_dict&#91;x&#93; for x in cy&#93;...&#41;</span>
          </td>
        </tr>
        <tr id='L113'>
          <td class='lineno'>113</td>
          <td class='tracecount excl'>2 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>12 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              10 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L78'>einsum&#33;</a>
              <br />
            </div>
            <span class='code'>        return einsum&#33;&#40;&#40;cy,&#41;, iyv, &#40;y_,&#41;, y, sx, sy, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L114'>
          <td class='lineno'>114</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    else</span>
          </td>
        </tr>
        <tr id='L115'>
          <td class='lineno'>115</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>182 &#40;2 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              180 &#40;99 &#37;&#41;
              samples spent calling
              <a href='binaryrules.jl-9cc4c5013c534aa7acdfb0aa406bb357a4383a5e.html#L129'>binary_einsum&#33;</a>
              <br />
              1 &#40;1 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L119'>safe_reshape</a>
              <br />
            </div>
            <span class='code'>        binary_einsum&#33;&#40;rule, x1_, x2_, safe_reshape&#40;y, s3&#41;, sx, sy&#41;</span>
          </td>
        </tr>
        <tr id='L116'>
          <td class='lineno'>116</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return y</span>
          </td>
        </tr>
        <tr id='L117'>
          <td class='lineno'>117</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L118'>
          <td class='lineno'>118</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L119'>
          <td class='lineno'>119</td>
          <td class='tracecount excl'>5 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>7 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              7 &#40;0 &#37;&#41;
              samples spent in safe_reshape
              <br />
              3 &#40;43 &#37;&#41; &#40;ex.&#41;,
              3 &#40;43 &#37;&#41; &#40;incl.&#41;
              when called from einsum&#33;
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L108'>line 108</a>
              <br />
              2 &#40;29 &#37;&#41; &#40;ex.&#41;,
              3 &#40;43 &#37;&#41; &#40;incl.&#41;
              when called from einsum&#33;
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L107'>line 107</a>
              <br />
              
              1 &#40;14 &#37;&#41; &#40;incl.&#41;
              when called from einsum&#33;
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L115'>line 115</a>
              <br />
            </div>
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='reshapedarray.jl-e699fe85bbcca1900e0dbbb16cec4bcbfba5babd.html#L40'>reshape</a>
              <br />
            </div>
            <span class='code'>safe_reshape&#40;x, sz&#41; &#61; reshape&#40;x, &#40;sz...,&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L120'>
          <td class='lineno'>120</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L121'>
          <td class='lineno'>121</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              661 &#40;9 &#37;&#41;
              samples spent in simplifyto
              <br />
              2 &#40;0 &#37;&#41; &#40;ex.&#41;,
              443 &#40;67 &#37;&#41; &#40;incl.&#41;
              when called from einsum&#33;
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L106'>line 106</a>
              <br />
              
              218 &#40;33 &#37;&#41; &#40;incl.&#41;
              when called from einsum&#33;
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L105'>line 105</a>
              <br />
            </div>
            
            <span class='code'>function simplifyto&#40;ix1, c1, x1, size_dict::Dict&#123;LT&#125;&#41; where LT</span>
          </td>
        </tr>
        <tr id='L122'>
          <td class='lineno'>122</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if c1 &#33;&#61; ix1</span>
          </td>
        </tr>
        <tr id='L123'>
          <td class='lineno'>123</td>
          <td class='tracecount excl'>2 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>78 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              76 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L421'>similar</a>
              <br />
            </div>
            <span class='code'>        xs1 &#61; similar&#40;x1, &#40;&#91;size_dict&#91;l&#93; for l in c1&#93;...,&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L124'>
          <td class='lineno'>124</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>583 &#40;8 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              583 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L78'>einsum&#33;</a>
              <br />
            </div>
            <span class='code'>        return einsum&#33;&#40;&#40;_collect&#40;LT,ix1&#41;,&#41;, c1, &#40;x1,&#41;, xs1, true, false, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L125'>
          <td class='lineno'>125</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    else</span>
          </td>
        </tr>
        <tr id='L126'>
          <td class='lineno'>126</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return x1</span>
          </td>
        </tr>
        <tr id='L127'>
          <td class='lineno'>127</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L128'>
          <td class='lineno'>128</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L129'>
          <td class='lineno'>129</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L130'>
          <td class='lineno'>130</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L131'>
          <td class='lineno'>131</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>Get the expected labels.</span>
          </td>
        </tr>
        <tr id='L132'>
          <td class='lineno'>132</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L133'>
          <td class='lineno'>133</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              5 &#40;0 &#37;&#41;
              samples spent in analyze_binary
              <br />
              
              5 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from einsum&#33;
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L103'>line 103</a>
              <br />
            </div>
            
            <span class='code'>function analyze_binary&#40;ix1::Vector&#123;T&#125;, ix2::Vector&#123;T&#125;, iy::Vector&#123;T&#125;, size_dict::Dict&#123;T,Int&#125;&#41; where T</span>
          </td>
        </tr>
        <tr id='L134'>
          <td class='lineno'>134</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L181'>_analyze_binary_input</a>
              <br />
            </div>
            <span class='code'>    ix_inner, ix1_outer, ix2_outer, batch &#61; _analyze_binary_input&#40;ix1, ix2, iy&#41;</span>
          </td>
        </tr>
        <tr id='L135'>
          <td class='lineno'>135</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L2031'>vcat</a>
              <br />
            </div>
            <span class='code'>    c1 &#61; vcat&#40;ix1_outer, ix_inner, batch&#41;</span>
          </td>
        </tr>
        <tr id='L136'>
          <td class='lineno'>136</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    c2 &#61; vcat&#40;ix_inner, ix2_outer, batch&#41;</span>
          </td>
        </tr>
        <tr id='L137'>
          <td class='lineno'>137</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cy &#61; vcat&#40;ix1_outer, ix2_outer, batch&#41;</span>
          </td>
        </tr>
        <tr id='L138'>
          <td class='lineno'>138</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    si &#61; prod&#40;map&#40;x-&gt;size_dict&#91;x&#93;, ix1_outer&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L139'>
          <td class='lineno'>139</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    sj &#61; prod&#40;map&#40;x-&gt;size_dict&#91;x&#93;, ix_inner&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L140'>
          <td class='lineno'>140</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    sk &#61; prod&#40;map&#40;x-&gt;size_dict&#91;x&#93;, ix2_outer&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L141'>
          <td class='lineno'>141</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    sl &#61; prod&#40;map&#40;x-&gt;size_dict&#91;x&#93;, batch&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L142'>
          <td class='lineno'>142</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    has_i &#61; &#33;isempty&#40;ix1_outer&#41;</span>
          </td>
        </tr>
        <tr id='L143'>
          <td class='lineno'>143</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    has_j &#61; &#33;isempty&#40;ix_inner&#41;</span>
          </td>
        </tr>
        <tr id='L144'>
          <td class='lineno'>144</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    has_k &#61; &#33;isempty&#40;ix2_outer&#41;</span>
          </td>
        </tr>
        <tr id='L145'>
          <td class='lineno'>145</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    has_l &#61; &#33;isempty&#40;batch&#41;</span>
          </td>
        </tr>
        <tr id='L146'>
          <td class='lineno'>146</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L448'>getindex</a>
              <br />
            </div>
            <span class='code'>    i1 &#61; Char&#91;&#93;</span>
          </td>
        </tr>
        <tr id='L147'>
          <td class='lineno'>147</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    i2 &#61; Char&#91;&#93;</span>
          </td>
        </tr>
        <tr id='L148'>
          <td class='lineno'>148</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    iyb &#61; Char&#91;&#93;</span>
          </td>
        </tr>
        <tr id='L149'>
          <td class='lineno'>149</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    s1 &#61; Int&#91;&#93;</span>
          </td>
        </tr>
        <tr id='L150'>
          <td class='lineno'>150</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    s2 &#61; Int&#91;&#93;</span>
          </td>
        </tr>
        <tr id='L151'>
          <td class='lineno'>151</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    s3 &#61; Int&#91;&#93;</span>
          </td>
        </tr>
        <tr id='L152'>
          <td class='lineno'>152</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if has_i</span>
          </td>
        </tr>
        <tr id='L153'>
          <td class='lineno'>153</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;i1, &#39;i&#39;&#41;</span>
          </td>
        </tr>
        <tr id='L154'>
          <td class='lineno'>154</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L1119'>push&#33;</a>
              <br />
            </div>
            <span class='code'>        push&#33;&#40;iyb, &#39;i&#39;&#41;</span>
          </td>
        </tr>
        <tr id='L155'>
          <td class='lineno'>155</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;s1, si&#41;</span>
          </td>
        </tr>
        <tr id='L156'>
          <td class='lineno'>156</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;s3, si&#41;</span>
          </td>
        </tr>
        <tr id='L157'>
          <td class='lineno'>157</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L158'>
          <td class='lineno'>158</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if has_j</span>
          </td>
        </tr>
        <tr id='L159'>
          <td class='lineno'>159</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;i1, &#39;j&#39;&#41;</span>
          </td>
        </tr>
        <tr id='L160'>
          <td class='lineno'>160</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;i2, &#39;j&#39;&#41;</span>
          </td>
        </tr>
        <tr id='L161'>
          <td class='lineno'>161</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;s1, sj&#41;</span>
          </td>
        </tr>
        <tr id='L162'>
          <td class='lineno'>162</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;s2, sj&#41;</span>
          </td>
        </tr>
        <tr id='L163'>
          <td class='lineno'>163</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L164'>
          <td class='lineno'>164</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if has_k</span>
          </td>
        </tr>
        <tr id='L165'>
          <td class='lineno'>165</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;i2, &#39;k&#39;&#41;</span>
          </td>
        </tr>
        <tr id='L166'>
          <td class='lineno'>166</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;iyb, &#39;k&#39;&#41;</span>
          </td>
        </tr>
        <tr id='L167'>
          <td class='lineno'>167</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;s2, sk&#41;</span>
          </td>
        </tr>
        <tr id='L168'>
          <td class='lineno'>168</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;s3, sk&#41;</span>
          </td>
        </tr>
        <tr id='L169'>
          <td class='lineno'>169</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L170'>
          <td class='lineno'>170</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if has_l</span>
          </td>
        </tr>
        <tr id='L171'>
          <td class='lineno'>171</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;i1, &#39;l&#39;&#41;</span>
          </td>
        </tr>
        <tr id='L172'>
          <td class='lineno'>172</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;i2, &#39;l&#39;&#41;</span>
          </td>
        </tr>
        <tr id='L173'>
          <td class='lineno'>173</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;iyb, &#39;l&#39;&#41;</span>
          </td>
        </tr>
        <tr id='L174'>
          <td class='lineno'>174</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;s1, sl&#41;</span>
          </td>
        </tr>
        <tr id='L175'>
          <td class='lineno'>175</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;s2, sl&#41;</span>
          </td>
        </tr>
        <tr id='L176'>
          <td class='lineno'>176</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;s3, sl&#41;</span>
          </td>
        </tr>
        <tr id='L177'>
          <td class='lineno'>177</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L178'>
          <td class='lineno'>178</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return c1, c2, cy, s1, s2, s3, i1, i2, iyb</span>
          </td>
        </tr>
        <tr id='L179'>
          <td class='lineno'>179</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L180'>
          <td class='lineno'>180</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L181'>
          <td class='lineno'>181</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              1 &#40;0 &#37;&#41;
              samples spent in _analyze_binary_input
              <br />
              
              1 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from analyze_binary
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L134'>line 134</a>
              <br />
            </div>
            
            <span class='code'>function _analyze_binary_input&#40;ix1::Vector&#123;T&#125;, ix2::Vector&#123;T&#125;, iy::Vector&#123;T&#125;&#41; where T</span>
          </td>
        </tr>
        <tr id='L182'>
          <td class='lineno'>182</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ix1_batch &#61; T&#91;&#93;</span>
          </td>
        </tr>
        <tr id='L183'>
          <td class='lineno'>183</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ix1_inner &#61; T&#91;&#93;</span>
          </td>
        </tr>
        <tr id='L184'>
          <td class='lineno'>184</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L448'>getindex</a>
              <br />
            </div>
            <span class='code'>    ix1_outer &#61; T&#91;&#93;</span>
          </td>
        </tr>
        <tr id='L185'>
          <td class='lineno'>185</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for l1 in ix1</span>
          </td>
        </tr>
        <tr id='L186'>
          <td class='lineno'>186</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        if l1 ∈ ix2</span>
          </td>
        </tr>
        <tr id='L187'>
          <td class='lineno'>187</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            if l1 ∈ iy  # batch</span>
          </td>
        </tr>
        <tr id='L188'>
          <td class='lineno'>188</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                l1 ∉ ix1_batch &amp;&amp; push&#33;&#40;ix1_batch, l1&#41;</span>
          </td>
        </tr>
        <tr id='L189'>
          <td class='lineno'>189</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            else        # inner</span>
          </td>
        </tr>
        <tr id='L190'>
          <td class='lineno'>190</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                l1 ∉ ix1_inner &amp;&amp; push&#33;&#40;ix1_inner, l1&#41;</span>
          </td>
        </tr>
        <tr id='L191'>
          <td class='lineno'>191</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L192'>
          <td class='lineno'>192</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        elseif l1 ∈ iy  # outer</span>
          </td>
        </tr>
        <tr id='L193'>
          <td class='lineno'>193</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            l1 ∉ ix1_outer &amp;&amp; push&#33;&#40;ix1_outer, l1&#41;</span>
          </td>
        </tr>
        <tr id='L194'>
          <td class='lineno'>194</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        else</span>
          </td>
        </tr>
        <tr id='L195'>
          <td class='lineno'>195</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # dangling</span>
          </td>
        </tr>
        <tr id='L196'>
          <td class='lineno'>196</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L197'>
          <td class='lineno'>197</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L198'>
          <td class='lineno'>198</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ix2_outer &#61; T&#91;&#93;     # outer dimension of x2</span>
          </td>
        </tr>
        <tr id='L199'>
          <td class='lineno'>199</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for l2 in ix2</span>
          </td>
        </tr>
        <tr id='L200'>
          <td class='lineno'>200</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        if l2 ∉ ix1 &amp;&amp; l2 ∈ iy &amp;&amp; l2 ∉ ix2_outer</span>
          </td>
        </tr>
        <tr id='L201'>
          <td class='lineno'>201</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            push&#33;&#40;ix2_outer, l2&#41;</span>
          </td>
        </tr>
        <tr id='L202'>
          <td class='lineno'>202</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L203'>
          <td class='lineno'>203</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L204'>
          <td class='lineno'>204</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ix1_inner, ix1_outer, ix2_outer, ix1_batch</span>
          </td>
        </tr>
        <tr id='L205'>
          <td class='lineno'>205</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

