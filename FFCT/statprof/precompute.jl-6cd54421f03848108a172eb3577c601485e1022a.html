<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - ../../../.julia/packages/FastSpecSoG/VvHyd/src/FFCT/precompute.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Wed, 21 Feb 2024 12:22:23
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># precomputings</span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@inline @inbounds function set_zeros&#33;&#40;a::AbstractArray&#123;T&#125;&#41; where&#123;T &lt;: Number&#125;</span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              2 &#40;0 &#37;&#41;
              samples spent in set_zeros&#33;
              <br />
              
              2 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from real2Cheb&#33;
              <a href='nugrid_interpolate.jl-8b49c6f82ba551cc1ba45bf83952282a76b7b918.html#L106'>line 106</a>
              <br />
            </div>
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L395'>fill&#33;</a>
              <br />
            </div>
            <span class='code'>    return fill&#33;&#40;a, zero&#40;T&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@inline function chebpoly&#40;n::Int, x::T, scale::T&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'>12 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>196 &#40;3 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              196 &#40;3 &#37;&#41;
              samples spent in chebpoly
              <br />
              12 &#40;6 &#37;&#41; &#40;ex.&#41;,
              195 &#40;99 &#37;&#41; &#40;incl.&#41;
              when called from gather_nu_single
              <a href='nugrid_gather.jl-c20d1ca5fd61decb6dd3f64ff074246383bc916c.html#L9'>line 9</a>
              <br />
              
              1 &#40;1 &#37;&#41; &#40;incl.&#41;
              when called from real2Cheb&#33;
              <a href='nugrid_interpolate.jl-8b49c6f82ba551cc1ba45bf83952282a76b7b918.html#L110'>line 110</a>
              <br />
            </div>
            <div class='callees'>
              147 &#40;80 &#37;&#41;
              samples spent calling
              <a href='trig.jl-754b444b7ea1504c049e8f6318d29ef8a3e13516.html#L98'>cos</a>
              <br />
              32 &#40;17 &#37;&#41;
              samples spent calling
              <a href='trig.jl-754b444b7ea1504c049e8f6318d29ef8a3e13516.html#L671'>acos</a>
              <br />
              5 &#40;3 &#37;&#41;
              samples spent calling
              <a href='float.jl-1010c8f5843198c1fef813a37adbfb7ed37edc9a.html#L98'>cos</a>
              <br />
            </div>
            <span class='code'>    return cos&#40;n * acos&#40;x / scale&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># precompute the parameters to be used</span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function FFCT_precompute&#40;L::NTuple&#123;3, T&#125;, N_grid::NTuple&#123;3, Int&#125;, uspara::USeriesPara&#123;T&#125;, M_mid::Int, n_atoms::Int&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    L_x, L_y, L_z &#61; L</span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    N_x, N_y, N_z &#61; N_grid</span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k_x &#61; Vector&#123;T&#125;&#40;&#91;2π * i / L_x for i in -N_x:N_x&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k_y &#61; Vector&#123;T&#125;&#40;&#91;2π * i / L_y for i in -N_y:N_y&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    r_z &#61; Vector&#123;T&#125;&#40;&#91;L_z / 2 * &#40; 1.0 - cos&#40;&#40;2i - 1&#41;*π / 2N_z&#41; &#41; for i in 1:N_z&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k_mat &#61; zeros&#40;T, 2N_x &#43; 1, 2N_y &#43; 1&#41;</span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    kx_mat &#61; zeros&#40;T, 2N_x &#43; 1, 2N_y &#43; 1&#41;</span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ky_mat &#61; zeros&#40;T, 2N_x &#43; 1, 2N_y &#43; 1&#41;</span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L23'>
          <td class='lineno'>23</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in 1:2N_x &#43; 1, j in 1:2N_y &#43; 1</span>
          </td>
        </tr>
        <tr id='L24'>
          <td class='lineno'>24</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        k_mat&#91;i, j&#93; &#61; sqrt&#40;k_x&#91;i&#93;^2 &#43; k_y&#91;j&#93;^2&#41;</span>
          </td>
        </tr>
        <tr id='L25'>
          <td class='lineno'>25</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        kx_mat&#91;i, j&#93; &#61; k_x&#91;i&#93;</span>
          </td>
        </tr>
        <tr id='L26'>
          <td class='lineno'>26</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        ky_mat&#91;i, j&#93; &#61; k_y&#91;j&#93;</span>
          </td>
        </tr>
        <tr id='L27'>
          <td class='lineno'>27</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L28'>
          <td class='lineno'>28</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L29'>
          <td class='lineno'>29</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # xy k space grid, z real space grid</span>
          </td>
        </tr>
        <tr id='L30'>
          <td class='lineno'>30</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    H_r &#61; zeros&#40;Complex&#123;T&#125;, 2N_x &#43; 1, 2N_y &#43; 1, N_z&#41;</span>
          </td>
        </tr>
        <tr id='L31'>
          <td class='lineno'>31</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # xy k space grid, z ChebCoefs</span>
          </td>
        </tr>
        <tr id='L32'>
          <td class='lineno'>32</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    H_c &#61; zeros&#40;Complex&#123;T&#125;, 2N_x &#43; 1, 2N_y &#43; 1, N_z&#41;</span>
          </td>
        </tr>
        <tr id='L33'>
          <td class='lineno'>33</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # solution to the linear eqs, xy k space grid, z ChebCoefs</span>
          </td>
        </tr>
        <tr id='L34'>
          <td class='lineno'>34</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    H_s &#61; zeros&#40;Complex&#123;T&#125;, 2N_x &#43; 1, 2N_y &#43; 1, N_z&#41;</span>
          </td>
        </tr>
        <tr id='L35'>
          <td class='lineno'>35</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L36'>
          <td class='lineno'>36</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    M &#61; length&#40;uspara.sw&#41;</span>
          </td>
        </tr>
        <tr id='L37'>
          <td class='lineno'>37</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    M_range &#61; M - M_mid</span>
          </td>
        </tr>
        <tr id='L38'>
          <td class='lineno'>38</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    us_mat &#61; zeros&#40;T, 2N_x &#43; 1, 2N_y &#43; 1, M_range&#41;</span>
          </td>
        </tr>
        <tr id='L39'>
          <td class='lineno'>39</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for l in 1:M_range</span>
          </td>
        </tr>
        <tr id='L40'>
          <td class='lineno'>40</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        sl, wl &#61; uspara.sw&#91;l &#43; M_mid&#93;</span>
          </td>
        </tr>
        <tr id='L41'>
          <td class='lineno'>41</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        us_mat&#91;:, :, l&#93; &#61; exp.&#40; - sl^2 .* k_mat.^2 ./ 4&#41;</span>
          </td>
        </tr>
        <tr id='L42'>
          <td class='lineno'>42</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L43'>
          <td class='lineno'>43</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L44'>
          <td class='lineno'>44</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ivsm &#61; inverse_mat&#40;N_grid, L&#91;3&#93;, k_x, k_y&#41;</span>
          </td>
        </tr>
        <tr id='L45'>
          <td class='lineno'>45</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L46'>
          <td class='lineno'>46</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # the boundary condition at z &#61; 0 and z &#61; L_z</span>
          </td>
        </tr>
        <tr id='L47'>
          <td class='lineno'>47</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    b_l &#61; zeros&#40;Complex&#123;T&#125;, 2N_x &#43; 1, 2N_y &#43; 1&#41;</span>
          </td>
        </tr>
        <tr id='L48'>
          <td class='lineno'>48</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    b_u &#61; zeros&#40;Complex&#123;T&#125;, 2N_x &#43; 1, 2N_y &#43; 1&#41;</span>
          </td>
        </tr>
        <tr id='L49'>
          <td class='lineno'>49</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    phase_x &#61; zeros&#40;Complex&#123;T&#125;, 2N_x &#43; 1&#41;</span>
          </td>
        </tr>
        <tr id='L50'>
          <td class='lineno'>50</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    phase_y &#61; zeros&#40;Complex&#123;T&#125;, 2N_y &#43; 1&#41;</span>
          </td>
        </tr>
        <tr id='L51'>
          <td class='lineno'>51</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L52'>
          <td class='lineno'>52</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    phase_xs &#61; zeros&#40;Complex&#123;T&#125;, 2N_x &#43; 1, n_atoms&#41;</span>
          </td>
        </tr>
        <tr id='L53'>
          <td class='lineno'>53</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    phase_ys &#61; zeros&#40;Complex&#123;T&#125;, 2N_y &#43; 1, n_atoms&#41;</span>
          </td>
        </tr>
        <tr id='L54'>
          <td class='lineno'>54</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    phase_xys &#61; zeros&#40;Complex&#123;T&#125;, 2N_x &#43; 1, 2N_y &#43; 1, n_atoms&#41;</span>
          </td>
        </tr>
        <tr id='L55'>
          <td class='lineno'>55</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L56'>
          <td class='lineno'>56</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    rhs &#61; zeros&#40;Complex&#123;T&#125;, N_z &#43; 2&#41;</span>
          </td>
        </tr>
        <tr id='L57'>
          <td class='lineno'>57</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    sol &#61; zeros&#40;Complex&#123;T&#125;, N_z &#43; 2&#41;</span>
          </td>
        </tr>
        <tr id='L58'>
          <td class='lineno'>58</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L59'>
          <td class='lineno'>59</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    sort_z &#61; zeros&#40;Int, n_atoms&#41;</span>
          </td>
        </tr>
        <tr id='L60'>
          <td class='lineno'>60</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    z &#61; zeros&#40;T, n_atoms&#41;</span>
          </td>
        </tr>
        <tr id='L61'>
          <td class='lineno'>61</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L62'>
          <td class='lineno'>62</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    size_dict &#61; Dict&#40;&#39;i&#39; &#61;&gt; 2N_x &#43; 1, &#39;j&#39; &#61;&gt; 2N_y &#43; 1, &#39;k&#39; &#61;&gt; N_z, &#39;l&#39; &#61;&gt; M_range, &#39;n&#39; &#61;&gt; n_atoms&#41;</span>
          </td>
        </tr>
        <tr id='L63'>
          <td class='lineno'>63</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    temp_ijlk &#61; zeros&#40;Complex&#123;T&#125;, &#40;size_dict&#91;&#39;i&#39;&#93;, size_dict&#91;&#39;j&#39;&#93;, size_dict&#91;&#39;l&#39;&#93;, size_dict&#91;&#39;k&#39;&#93;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L64'>
          <td class='lineno'>64</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    temp_ijl &#61; zeros&#40;Complex&#123;T&#125;, &#40;size_dict&#91;&#39;i&#39;&#93;, size_dict&#91;&#39;j&#39;&#93;, size_dict&#91;&#39;l&#39;&#93;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L65'>
          <td class='lineno'>65</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    z_coef &#61; zeros&#40;T, M_range, N_z, n_atoms&#41;</span>
          </td>
        </tr>
        <tr id='L66'>
          <td class='lineno'>66</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    exp_coef &#61; zeros&#40;T, M_range, N_z, n_atoms&#41;</span>
          </td>
        </tr>
        <tr id='L67'>
          <td class='lineno'>67</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L68'>
          <td class='lineno'>68</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return k_x, k_y, k_mat, r_z, Complex&#123;T&#125;.&#40;us_mat&#41;, H_r, H_c, H_s, ivsm, b_l, b_u, phase_x, phase_y, phase_xs, phase_ys, phase_xys, rhs, sol, sort_z, z, size_dict, temp_ijlk, temp_ijl, z_coef, exp_coef</span>
          </td>
        </tr>
        <tr id='L69'>
          <td class='lineno'>69</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L70'>
          <td class='lineno'>70</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L71'>
          <td class='lineno'>71</td>
          <td class='tracecount excl'>10 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>10 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              811 &#40;11 &#37;&#41;
              samples spent in revise_phase_neg&#33;
              <br />
              7 &#40;1 &#37;&#41; &#40;ex.&#41;,
              417 &#40;51 &#37;&#41; &#40;incl.&#41;
              when called from boundaries_single&#33;
              <a href='linear_eqs.jl-a93ba53a04fbab7a09b2c51eb7124bd3c86af2cc.html#L10'>line 10</a>
              <br />
              3 &#40;0 &#37;&#41; &#40;ex.&#41;,
              394 &#40;49 &#37;&#41; &#40;incl.&#41;
              when called from revise_phase_neg_all&#33;
              <a href='precompute.jl-6cd54421f03848108a172eb3577c601485e1022a.html#L91'>line 91</a>
              <br />
            </div>
            
            <span class='code'>@inbounds function revise_phase_neg&#33;&#40;phase_x::AbstractArray&#123;Complex&#123;T&#125;, 1&#125;, phase_y::AbstractArray&#123;Complex&#123;T&#125;, 1&#125;, k_x::Vector&#123;T&#125;, k_y::Vector&#123;T&#125;, x::T, y::T&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L72'>
          <td class='lineno'>72</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L73'>
          <td class='lineno'>73</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>410 &#40;6 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              410 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-9538a2221b315be425e9c47ec7c3883483af8540.html#L911'>materialize&#33;</a>
              <br />
            </div>
            <span class='code'>    phase_x .&#61; exp.&#40;-T&#40;1&#41;im .* k_x .* x&#41;</span>
          </td>
        </tr>
        <tr id='L74'>
          <td class='lineno'>74</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>391 &#40;5 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              391 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-9538a2221b315be425e9c47ec7c3883483af8540.html#L911'>materialize&#33;</a>
              <br />
            </div>
            <span class='code'>    phase_y .&#61; exp.&#40;-T&#40;1&#41;im .* k_y .* y&#41;</span>
          </td>
        </tr>
        <tr id='L75'>
          <td class='lineno'>75</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L76'>
          <td class='lineno'>76</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return nothing</span>
          </td>
        </tr>
        <tr id='L77'>
          <td class='lineno'>77</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L78'>
          <td class='lineno'>78</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L79'>
          <td class='lineno'>79</td>
          <td class='tracecount excl'>2 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>2 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              398 &#40;5 &#37;&#41;
              samples spent in revise_phase_pos&#33;
              <br />
              2 &#40;1 &#37;&#41; &#40;ex.&#41;,
              398 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from gather_nu_single
              <a href='nugrid_gather.jl-c20d1ca5fd61decb6dd3f64ff074246383bc916c.html#L6'>line 6</a>
              <br />
            </div>
            
            <span class='code'>@inbounds function revise_phase_pos&#33;&#40;phase_x::AbstractArray&#123;Complex&#123;T&#125;, 1&#125;, phase_y::AbstractArray&#123;Complex&#123;T&#125;, 1&#125;, k_x::Vector&#123;T&#125;, k_y::Vector&#123;T&#125;, x::T, y::T&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L80'>
          <td class='lineno'>80</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L81'>
          <td class='lineno'>81</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>188 &#40;3 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              188 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-9538a2221b315be425e9c47ec7c3883483af8540.html#L911'>materialize&#33;</a>
              <br />
            </div>
            <span class='code'>    phase_x .&#61; exp.&#40;T&#40;1&#41;im .* k_x .* x&#41;</span>
          </td>
        </tr>
        <tr id='L82'>
          <td class='lineno'>82</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>208 &#40;3 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              208 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-9538a2221b315be425e9c47ec7c3883483af8540.html#L911'>materialize&#33;</a>
              <br />
            </div>
            <span class='code'>    phase_y .&#61; exp.&#40;T&#40;1&#41;im .* k_y .* y&#41;</span>
          </td>
        </tr>
        <tr id='L83'>
          <td class='lineno'>83</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L84'>
          <td class='lineno'>84</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return nothing</span>
          </td>
        </tr>
        <tr id='L85'>
          <td class='lineno'>85</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L86'>
          <td class='lineno'>86</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L87'>
          <td class='lineno'>87</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              673 &#40;9 &#37;&#41;
              samples spent in revise_phase_neg_all&#33;
              <br />
              77 &#40;11 &#37;&#41; &#40;ex.&#41;,
              673 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from interpolate_nu_einsum&#33;
              <a href='nugrid_interpolate.jl-8b49c6f82ba551cc1ba45bf83952282a76b7b918.html#L40'>line 40</a>
              <br />
            </div>
            
            <span class='code'>@inbounds function revise_phase_neg_all&#33;&#40;qs::Vector&#123;T&#125;, poses::Vector&#123;NTuple&#123;3, T&#125;&#125;, phase_xs::Array&#123;Complex&#123;T&#125;, 2&#125;, phase_ys::Array&#123;Complex&#123;T&#125;, 2&#125;, phase_xys::Array&#123;Complex&#123;T&#125;, 3&#125;, k_x::Vector&#123;T&#125;, k_y::Vector&#123;T&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L88'>
          <td class='lineno'>88</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L89'>
          <td class='lineno'>89</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for n in 1:size&#40;poses, 1&#41;</span>
          </td>
        </tr>
        <tr id='L90'>
          <td class='lineno'>90</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        x, y, z &#61; poses&#91;n&#93;</span>
          </td>
        </tr>
        <tr id='L91'>
          <td class='lineno'>91</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>398 &#40;5 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              394 &#40;99 &#37;&#41;
              samples spent calling
              <a href='precompute.jl-6cd54421f03848108a172eb3577c601485e1022a.html#L71'>revise_phase_neg&#33;</a>
              <br />
              2 &#40;1 &#37;&#41;
              samples spent calling
              <a href='trig.jl-754b444b7ea1504c049e8f6318d29ef8a3e13516.html#L175'>sincos</a>
              <br />
              2 &#40;1 &#37;&#41;
              samples spent calling
              <a href='exp.jl-a8ef204d9f107450c453d53ddf0cca289e6595be.html#L327'>exp</a>
              <br />
            </div>
            <span class='code'>        revise_phase_neg&#33;&#40;&#40;@view phase_xs&#91;:, n&#93;&#41;, &#40;@view phase_ys&#91;:, n&#93;&#41;, k_x, k_y, x, y&#41;</span>
          </td>
        </tr>
        <tr id='L92'>
          <td class='lineno'>92</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L93'>
          <td class='lineno'>93</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L94'>
          <td class='lineno'>94</td>
          <td class='tracecount excl'>5 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>5 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>    for n in 1:size&#40;phase_xys, 3&#41;, j in 1:size&#40;phase_xys, 2&#41;, i in 1:size&#40;phase_xys, 1&#41;</span>
          </td>
        </tr>
        <tr id='L95'>
          <td class='lineno'>95</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>196 &#40;3 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              109 &#40;56 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L1024'>setindex&#33;</a>
              <br />
              42 &#40;21 &#37;&#41;
              samples spent calling
              <a href='operators.jl-686c6e14b62f7e1edd63eed9861cf94955771a50.html#L587'>*</a>
              <br />
              31 &#40;16 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-f0c8802a556c409b803937db99f588c9c5999872.html#L14'>getindex</a>
              <br />
              14 &#40;7 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-f0c8802a556c409b803937db99f588c9c5999872.html#L0'>getindex</a>
              <br />
            </div>
            <span class='code'>        phase_xys&#91;i, j, n&#93; &#61; phase_xs&#91;i, n&#93; * phase_ys&#91;j, n&#93; * qs&#91;n&#93;</span>
          </td>
        </tr>
        <tr id='L96'>
          <td class='lineno'>96</td>
          <td class='tracecount excl'>55 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>57 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='range.jl-98f40bce68f1934881ccb1db6e729761ce82d53a.html#L901'>iterate</a>
              <br />
            </div>
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L97'>
          <td class='lineno'>97</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L98'>
          <td class='lineno'>98</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return nothing</span>
          </td>
        </tr>
        <tr id='L99'>
          <td class='lineno'>99</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L100'>
          <td class='lineno'>100</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L101'>
          <td class='lineno'>101</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># precompute the inverse matrix</span>
          </td>
        </tr>
        <tr id='L102'>
          <td class='lineno'>102</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function inverse_mat&#40;N_grid::NTuple&#123;3, Int&#125;, L_z::T, k_x::Vector&#123;T&#125;, k_y::Vector&#123;T&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L103'>
          <td class='lineno'>103</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    N_x, N_y, N_z &#61; N_grid</span>
          </td>
        </tr>
        <tr id='L104'>
          <td class='lineno'>104</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    inverse_mat &#61; zeros&#40;T, N_z &#43; 2, N_z &#43; 2, 2 * N_x &#43; 1, 2 * N_y &#43; 1&#41;</span>
          </td>
        </tr>
        <tr id='L105'>
          <td class='lineno'>105</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L106'>
          <td class='lineno'>106</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    scale &#61; L_z / T&#40;2&#41;</span>
          </td>
        </tr>
        <tr id='L107'>
          <td class='lineno'>107</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L108'>
          <td class='lineno'>108</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    A &#61; zeros&#40;T, N_z, N_z &#43; 2&#41;</span>
          </td>
        </tr>
        <tr id='L109'>
          <td class='lineno'>109</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    A&#91;2,2&#93; &#61; 1 / 8 * scale^2</span>
          </td>
        </tr>
        <tr id='L110'>
          <td class='lineno'>110</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    A&#91;2,4&#93; &#61; - 1 / 8 * scale^2</span>
          </td>
        </tr>
        <tr id='L111'>
          <td class='lineno'>111</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for s in 3:N_z</span>
          </td>
        </tr>
        <tr id='L112'>
          <td class='lineno'>112</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        k &#61; s - 1</span>
          </td>
        </tr>
        <tr id='L113'>
          <td class='lineno'>113</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        A&#91;s, s - 2&#93; &#61; scale^2 / &#40;2 * k * 2&#40;k - 1&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L114'>
          <td class='lineno'>114</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        A&#91;s, s&#93; &#61; - &#40;1 / 2&#40;k - 1&#41; &#43; 1 / 2&#40;k &#43; 1&#41;&#41; * scale^2 / 2k</span>
          </td>
        </tr>
        <tr id='L115'>
          <td class='lineno'>115</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        A&#91;s, s &#43; 2&#93; &#61; scale^2 / &#40;2k * 2&#40;k&#43;1&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L116'>
          <td class='lineno'>116</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L117'>
          <td class='lineno'>117</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L118'>
          <td class='lineno'>118</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    B &#61; zeros&#40;T, N_z, 2&#41;</span>
          </td>
        </tr>
        <tr id='L119'>
          <td class='lineno'>119</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    B&#91;1, 1&#93; &#61; T&#40;2&#41;</span>
          </td>
        </tr>
        <tr id='L120'>
          <td class='lineno'>120</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    B&#91;2, 2&#93; &#61; scale</span>
          </td>
        </tr>
        <tr id='L121'>
          <td class='lineno'>121</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L122'>
          <td class='lineno'>122</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    C &#61; zeros&#40;T, 2, N_z &#43; 2&#41;</span>
          </td>
        </tr>
        <tr id='L123'>
          <td class='lineno'>123</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for s &#61; 3:N_z</span>
          </td>
        </tr>
        <tr id='L124'>
          <td class='lineno'>124</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        k &#61; s - 1</span>
          </td>
        </tr>
        <tr id='L125'>
          <td class='lineno'>125</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        C&#91;1, s-2&#93; &#43;&#61; scale^2 * &#40;1/&#40;2*k&#41;&#41; * &#40;1/&#40;2*&#40;k-1&#41;&#41;&#41; * &#40;-1&#41;^k</span>
          </td>
        </tr>
        <tr id='L126'>
          <td class='lineno'>126</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        C&#91;1, s&#93; -&#61; scale^2 * &#40;&#40;1/&#40;2*k&#41;&#41; * &#40;1/&#40;2*&#40;k-1&#41;&#41;&#41; &#43; &#40;1/&#40;2*k&#41;&#41; * &#40;1/&#40;2*&#40;k&#43;1&#41;&#41;&#41;&#41; * &#40;-1&#41;^k</span>
          </td>
        </tr>
        <tr id='L127'>
          <td class='lineno'>127</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        C&#91;1, s&#43;2&#93; &#43;&#61; scale^2 * &#40;1/&#40;2*k&#41;&#41; * &#40;1/&#40;2*&#40;k&#43;1&#41;&#41;&#41; * &#40;-1&#41;^k</span>
          </td>
        </tr>
        <tr id='L128'>
          <td class='lineno'>128</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        </span>
          </td>
        </tr>
        <tr id='L129'>
          <td class='lineno'>129</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        C&#91;2, s-2&#93; &#43;&#61; scale^2 * &#40;1/&#40;2*k&#41;&#41; * &#40;1/&#40;2*&#40;k-1&#41;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L130'>
          <td class='lineno'>130</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        C&#91;2, s&#93; -&#61; scale^2 * &#40;&#40;1/&#40;2*k&#41;&#41; * &#40;1/&#40;2*&#40;k-1&#41;&#41;&#41; &#43; &#40;1/&#40;2*k&#41;&#41; * &#40;1/&#40;2*&#40;k&#43;1&#41;&#41;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L131'>
          <td class='lineno'>131</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        C&#91;2, s&#43;2&#93; &#43;&#61; scale^2 * &#40;1/&#40;2*k&#41;&#41; * &#40;1/&#40;2*&#40;k&#43;1&#41;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L132'>
          <td class='lineno'>132</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L133'>
          <td class='lineno'>133</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    C&#91;1, 2&#93; &#43;&#61; 1/8 * scale^2 * &#40;-1&#41;</span>
          </td>
        </tr>
        <tr id='L134'>
          <td class='lineno'>134</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    C&#91;1, 4&#93; -&#61; 1/8 * scale^2 * &#40;-1&#41;</span>
          </td>
        </tr>
        <tr id='L135'>
          <td class='lineno'>135</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    C&#91;2, 2&#93; &#43;&#61; 1/8 * scale^2</span>
          </td>
        </tr>
        <tr id='L136'>
          <td class='lineno'>136</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    C&#91;2, 4&#93; -&#61; 1/8 * scale^2</span>
          </td>
        </tr>
        <tr id='L137'>
          <td class='lineno'>137</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L138'>
          <td class='lineno'>138</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    D &#61; zeros&#40;T, 2, 2&#41;</span>
          </td>
        </tr>
        <tr id='L139'>
          <td class='lineno'>139</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    D&#91;1, 1&#93; &#61; T&#40;1&#41;</span>
          </td>
        </tr>
        <tr id='L140'>
          <td class='lineno'>140</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    D&#91;1, 2&#93; &#61; - scale</span>
          </td>
        </tr>
        <tr id='L141'>
          <td class='lineno'>141</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    D&#91;2, 1&#93; &#61; T&#40;1&#41;</span>
          </td>
        </tr>
        <tr id='L142'>
          <td class='lineno'>142</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    D&#91;2, 2&#93; &#61; scale</span>
          </td>
        </tr>
        <tr id='L143'>
          <td class='lineno'>143</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L144'>
          <td class='lineno'>144</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    divisor &#61; zeros&#40;T, N_z &#43; 2, N_z &#43; 2&#41;</span>
          </td>
        </tr>
        <tr id='L145'>
          <td class='lineno'>145</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in 1:2N_x &#43; 1, j in 1:2N_y &#43; 1</span>
          </td>
        </tr>
        <tr id='L146'>
          <td class='lineno'>146</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        k &#61; sqrt&#40;k_x&#91;i&#93;^2 &#43; k_y&#91;j&#93;^2&#41;</span>
          </td>
        </tr>
        <tr id='L147'>
          <td class='lineno'>147</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        if k &#33;&#61; zero&#40;T&#41;</span>
          </td>
        </tr>
        <tr id='L148'>
          <td class='lineno'>148</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            nu &#61; - k^2</span>
          </td>
        </tr>
        <tr id='L149'>
          <td class='lineno'>149</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            divisor&#91;1:N_z, 1:N_z&#93; &#61; A&#91;1:N_z, 1:N_z&#93; .* nu .&#43; T.&#40;I&#40;N_z&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L150'>
          <td class='lineno'>150</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            divisor&#91;1:N_z, N_z&#43;1:N_z&#43;2&#93; &#61; nu .* B&#91;1:N_z, 1:2&#93;</span>
          </td>
        </tr>
        <tr id='L151'>
          <td class='lineno'>151</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            divisor&#91;N_z&#43;1:N_z&#43;2, 1:N_z&#93; &#61; C&#91;1:2, 1:N_z&#93;</span>
          </td>
        </tr>
        <tr id='L152'>
          <td class='lineno'>152</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            divisor&#91;N_z&#43;1:N_z&#43;2, N_z&#43;1:N_z&#43;2&#93; &#61; D</span>
          </td>
        </tr>
        <tr id='L153'>
          <td class='lineno'>153</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L154'>
          <td class='lineno'>154</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            inverse_mat&#91;:,:,i,j&#93; &#61; inv&#40;divisor&#41;</span>
          </td>
        </tr>
        <tr id='L155'>
          <td class='lineno'>155</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L156'>
          <td class='lineno'>156</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L157'>
          <td class='lineno'>157</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L158'>
          <td class='lineno'>158</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return inverse_mat</span>
          </td>
        </tr>
        <tr id='L159'>
          <td class='lineno'>159</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

