<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - ../../../.julia/packages/FastSpecSoG/VvHyd/src/FFCT/nugrid_interpolate.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Wed, 21 Feb 2024 12:22:23
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@inline function Fourier_k&#40;i::Int, N::Int, L::T&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return T&#40;2Ï€ * &#40;i - 1 - N&#41; / L&#41;</span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              598 &#40;8 &#37;&#41;
              samples spent in revise_z_coef&#33;
              <br />
              192 &#40;32 &#37;&#41; &#40;ex.&#41;,
              598 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from interpolate_nu_einsum&#33;
              <a href='nugrid_interpolate.jl-8b49c6f82ba551cc1ba45bf83952282a76b7b918.html#L41'>line 41</a>
              <br />
            </div>
            
            <span class='code'>@inbounds function revise_z_coef&#33;&#40;z_coef::Array&#123;T, 3&#125;, exp_coef::Array&#123;T, 3&#125;, r_z::Vector&#123;T&#125;, poses::Vector&#123;NTuple&#123;3, T&#125;&#125;, uspara::USeriesPara&#123;T&#125;, M_mid::Int&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for n in 1:size&#40;poses, 1&#41;</span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        x, y, z &#61; poses&#91;n&#93;</span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        for k in 1:size&#40;r_z, 1&#41;</span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-f0c8802a556c409b803937db99f588c9c5999872.html#L13'>getindex</a>
              <br />
            </div>
            <span class='code'>            r_zk &#61; r_z&#91;k&#93;</span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='range.jl-98f40bce68f1934881ccb1db6e729761ce82d53a.html#L5'>Colon</a>
              <br />
            </div>
            <span class='code'>            for l in M_mid &#43; 1:length&#40;uspara.sw&#41;</span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>3 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              3 &#40;100 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-f0c8802a556c409b803937db99f588c9c5999872.html#L13'>getindex</a>
              <br />
            </div>
            <span class='code'>                sl, wl &#61; uspara.sw&#91;l&#93;</span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>6 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              6 &#40;100 &#37;&#41;
              samples spent calling
              <a href='float.jl-1010c8f5843198c1fef813a37adbfb7ed37edc9a.html#L412'>/</a>
              <br />
            </div>
            <span class='code'>                temp_z &#61; &#40;z - r_zk&#41;^2 / sl^2</span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'>41 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>377 &#40;5 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              336 &#40;100 &#37;&#41;
              samples spent calling
              <a href='exp.jl-a8ef204d9f107450c453d53ddf0cca289e6595be.html#L327'>exp</a>
              <br />
            </div>
            <span class='code'>                temp_exp &#61; exp&#40;-temp_z&#41;</span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>14 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              14 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L1024'>setindex&#33;</a>
              <br />
            </div>
            <span class='code'>                exp_coef&#91;l - M_mid, k, n&#93; &#61; temp_exp</span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>22 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              22 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L1024'>setindex&#33;</a>
              <br />
            </div>
            <span class='code'>                z_coef&#91;l - M_mid, k, n&#93; &#61; &#40;T&#40;2&#41; - T&#40;4&#41; * temp_z&#41; * temp_exp * sl^2</span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>22 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              22 &#40;100 &#37;&#41;
              samples spent calling
              <a href='range.jl-98f40bce68f1934881ccb1db6e729761ce82d53a.html#L901'>iterate</a>
              <br />
            </div>
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'>3 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>3 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return nothing</span>
          </td>
        </tr>
        <tr id='L23'>
          <td class='lineno'>23</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L24'>
          <td class='lineno'>24</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L25'>
          <td class='lineno'>25</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L26'>
          <td class='lineno'>26</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L27'>
          <td class='lineno'>27</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>H1&#91;i, j, k&#93; :&#61; phase_xys&#91;i, j, n&#93; * z_coef&#91;l, k, n&#93; * us_mat&#91;i, j, l&#93;</span>
          </td>
        </tr>
        <tr id='L28'>
          <td class='lineno'>28</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>H2&#91;i, j, k&#93; :&#61; phase_xys&#91;i, j, n&#93; * exp_coef&#91;l, k, n&#93; * k_mat&#91;i, j&#93; * us_mat&#91;i, j, l&#93;</span>
          </td>
        </tr>
        <tr id='L29'>
          <td class='lineno'>29</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L30'>
          <td class='lineno'>30</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L31'>
          <td class='lineno'>31</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              2247 &#40;31 &#37;&#41;
              samples spent in interpolate_nu_einsum&#33;
              <br />
              
              2247 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from energy_long_einsum
              <a href='energy_long.jl-7a7bb982ef2fa42807770cd492b7e09a2c3d1533.html#L56'>line 56</a>
              <br />
            </div>
            
            <span class='code'>@inbounds function interpolate_nu_einsum&#33;&#40;</span>
          </td>
        </tr>
        <tr id='L32'>
          <td class='lineno'>32</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    H_r::Array&#123;Complex&#123;T&#125;, 3&#125;,</span>
          </td>
        </tr>
        <tr id='L33'>
          <td class='lineno'>33</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    qs::Vector&#123;T&#125;, poses::Vector&#123;NTuple&#123;3, T&#125;&#125;, </span>
          </td>
        </tr>
        <tr id='L34'>
          <td class='lineno'>34</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k_x::Vector&#123;T&#125;, k_y::Vector&#123;T&#125;, k_mat::Array&#123;T, 2&#125;, </span>
          </td>
        </tr>
        <tr id='L35'>
          <td class='lineno'>35</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    phase_xs::Array&#123;Complex&#123;T&#125;, 2&#125;, phase_ys::Array&#123;Complex&#123;T&#125;, 2&#125;, phase_xys::Array&#123;Complex&#123;T&#125;, 3&#125;, </span>
          </td>
        </tr>
        <tr id='L36'>
          <td class='lineno'>36</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    z_coef::Array&#123;T, 3&#125;, exp_coef::Array&#123;T, 3&#125;, temp_ijlk::Array&#123;Complex&#123;T&#125;, 4&#125;, temp_ijl::Array&#123;Complex&#123;T&#125;, 3&#125;,</span>
          </td>
        </tr>
        <tr id='L37'>
          <td class='lineno'>37</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    r_z::Vector&#123;T&#125;, us_mat::Array&#123;Complex&#123;T&#125;, 3&#125;, uspara::USeriesPara&#123;T&#125;, M_mid::Int,  </span>
          </td>
        </tr>
        <tr id='L38'>
          <td class='lineno'>38</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    size_dict::Dict&#123;Char, Int64&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L39'>
          <td class='lineno'>39</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L40'>
          <td class='lineno'>40</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>679 &#40;9 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              673 &#40;99 &#37;&#41;
              samples spent calling
              <a href='precompute.jl-6cd54421f03848108a172eb3577c601485e1022a.html#L87'>revise_phase_neg_all&#33;</a>
              <br />
              6 &#40;1 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L87'>revise_phase_neg_all&#33;</a>
              <br />
            </div>
            <span class='code'>    revise_phase_neg_all&#33;&#40;qs, poses, phase_xs, phase_ys, phase_xys, k_x, k_y&#41;</span>
          </td>
        </tr>
        <tr id='L41'>
          <td class='lineno'>41</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>598 &#40;8 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              598 &#40;100 &#37;&#41;
              samples spent calling
              <a href='nugrid_interpolate.jl-8b49c6f82ba551cc1ba45bf83952282a76b7b918.html#L6'>revise_z_coef&#33;</a>
              <br />
            </div>
            <span class='code'>    revise_z_coef&#33;&#40;z_coef, exp_coef, r_z, poses, uspara, M_mid&#41;</span>
          </td>
        </tr>
        <tr id='L42'>
          <td class='lineno'>42</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L43'>
          <td class='lineno'>43</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # H1</span>
          </td>
        </tr>
        <tr id='L44'>
          <td class='lineno'>44</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>311 &#40;4 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              311 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L38'>einsum&#33;</a>
              <br />
            </div>
            <span class='code'>    einsum&#33;&#40;ein&quot;ijn, lkn -&gt; ijlk&quot;, &#40;phase_xys, z_coef&#41;, temp_ijlk, true, false, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L45'>
          <td class='lineno'>45</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>167 &#40;2 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              167 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L38'>einsum&#33;</a>
              <br />
            </div>
            <span class='code'>    einsum&#33;&#40;ein&quot;ijlk, ijl -&gt; ijk&quot;, &#40;temp_ijlk, us_mat&#41;, H_r, true, false, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L46'>
          <td class='lineno'>46</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L47'>
          <td class='lineno'>47</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # H2</span>
          </td>
        </tr>
        <tr id='L48'>
          <td class='lineno'>48</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>262 &#40;4 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              262 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L38'>einsum&#33;</a>
              <br />
            </div>
            <span class='code'>    einsum&#33;&#40;ein&quot;ijn, lkn -&gt; ijlk&quot;, &#40;phase_xys, exp_coef&#41;, temp_ijlk, true, false, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L49'>
          <td class='lineno'>49</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>65 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              65 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L38'>einsum&#33;</a>
              <br />
            </div>
            <span class='code'>    einsum&#33;&#40;ein&quot;ij, ijl -&gt; ijl&quot;, &#40;k_mat, us_mat&#41;, temp_ijl, true, false, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L50'>
          <td class='lineno'>50</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>165 &#40;2 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              165 &#40;100 &#37;&#41;
              samples spent calling
              <a href='einsum.jl-e3da92eb21867ed08c3c3001783f1bc4df9a4fc4.html#L38'>einsum&#33;</a>
              <br />
            </div>
            <span class='code'>    einsum&#33;&#40;ein&quot;ijlk, ijl -&gt; ijk&quot;, &#40;temp_ijlk, temp_ijl&#41;, H_r, true, true, size_dict&#41;</span>
          </td>
        </tr>
        <tr id='L51'>
          <td class='lineno'>51</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L52'>
          <td class='lineno'>52</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    H_r .*&#61; Ï€</span>
          </td>
        </tr>
        <tr id='L53'>
          <td class='lineno'>53</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L54'>
          <td class='lineno'>54</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return H_r</span>
          </td>
        </tr>
        <tr id='L55'>
          <td class='lineno'>55</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L56'>
          <td class='lineno'>56</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L57'>
          <td class='lineno'>57</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@inbounds function interpolate_nu_loop_single&#33;&#40;</span>
          </td>
        </tr>
        <tr id='L58'>
          <td class='lineno'>58</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    H_r::Array&#123;Complex&#123;T&#125;, 3&#125;,</span>
          </td>
        </tr>
        <tr id='L59'>
          <td class='lineno'>59</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    q::T, pos::NTuple&#123;3, T&#125;, </span>
          </td>
        </tr>
        <tr id='L60'>
          <td class='lineno'>60</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    N::NTuple&#123;3, Int&#125;, L::NTuple&#123;3, T&#125;, k_x::Vector&#123;T&#125;, k_y::Vector&#123;T&#125;, </span>
          </td>
        </tr>
        <tr id='L61'>
          <td class='lineno'>61</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    phase_x::Vector&#123;Complex&#123;T&#125;&#125;, phase_y::Vector&#123;Complex&#123;T&#125;&#125;, </span>
          </td>
        </tr>
        <tr id='L62'>
          <td class='lineno'>62</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    r_z::Vector&#123;T&#125;, us_mat::Array&#123;Complex&#123;T&#125;, 3&#125;, uspara::USeriesPara&#123;T&#125;, M_mid::Int&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L63'>
          <td class='lineno'>63</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L64'>
          <td class='lineno'>64</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    x, y, z &#61; pos</span>
          </td>
        </tr>
        <tr id='L65'>
          <td class='lineno'>65</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    revise_phase_neg&#33;&#40;phase_x, phase_y, k_x, k_y, x, y&#41;</span>
          </td>
        </tr>
        <tr id='L66'>
          <td class='lineno'>66</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L67'>
          <td class='lineno'>67</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for k in 1:size&#40;H_r, 3&#41;</span>
          </td>
        </tr>
        <tr id='L68'>
          <td class='lineno'>68</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        r_zk &#61; r_z&#91;k&#93;</span>
          </td>
        </tr>
        <tr id='L69'>
          <td class='lineno'>69</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        for l in M_mid &#43; 1:length&#40;uspara.sw&#41;</span>
          </td>
        </tr>
        <tr id='L70'>
          <td class='lineno'>70</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            sl, wl &#61; uspara.sw&#91;l&#93;</span>
          </td>
        </tr>
        <tr id='L71'>
          <td class='lineno'>71</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            exp_temp &#61; exp&#40;- &#40;z - r_zk&#41;^2 / sl^2&#41;</span>
          </td>
        </tr>
        <tr id='L72'>
          <td class='lineno'>72</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            z_temp &#61; T&#40;2&#41; - T&#40;4&#41; * &#40;z - r_zk&#41;^2 / sl^2</span>
          </td>
        </tr>
        <tr id='L73'>
          <td class='lineno'>73</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L74'>
          <td class='lineno'>74</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            for j in 1:size&#40;H_r, 2&#41;</span>
          </td>
        </tr>
        <tr id='L75'>
          <td class='lineno'>75</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                k_yj &#61; Fourier_k&#40;j, N&#91;2&#93;, L&#91;2&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L76'>
          <td class='lineno'>76</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                for i in 1:size&#40;H_r, 1&#41;</span>
          </td>
        </tr>
        <tr id='L77'>
          <td class='lineno'>77</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    k_xi &#61; Fourier_k&#40;i, N&#91;1&#93;, L&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L78'>
          <td class='lineno'>78</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    phase &#61; phase_x&#91;i&#93; * phase_y&#91;j&#93;</span>
          </td>
        </tr>
        <tr id='L79'>
          <td class='lineno'>79</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    us &#61; us_mat&#91;i, j, l - M_mid&#93;</span>
          </td>
        </tr>
        <tr id='L80'>
          <td class='lineno'>80</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    H_r&#91;i, j, k&#93; &#43;&#61; q * Ï€ * phase * &#40;z_temp &#43; &#40;k_xi^2 &#43; k_yj^2&#41; * sl^2&#41; * exp_temp * us</span>
          </td>
        </tr>
        <tr id='L81'>
          <td class='lineno'>81</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                end</span>
          </td>
        </tr>
        <tr id='L82'>
          <td class='lineno'>82</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L83'>
          <td class='lineno'>83</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L84'>
          <td class='lineno'>84</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L85'>
          <td class='lineno'>85</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L86'>
          <td class='lineno'>86</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return H_r</span>
          </td>
        </tr>
        <tr id='L87'>
          <td class='lineno'>87</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L88'>
          <td class='lineno'>88</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L89'>
          <td class='lineno'>89</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function interpolate_nu_loop&#33;&#40;</span>
          </td>
        </tr>
        <tr id='L90'>
          <td class='lineno'>90</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    H_r::Array&#123;Complex&#123;T&#125;, 3&#125;,</span>
          </td>
        </tr>
        <tr id='L91'>
          <td class='lineno'>91</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    qs::Vector&#123;T&#125;, poses::Vector&#123;NTuple&#123;3, T&#125;&#125;, </span>
          </td>
        </tr>
        <tr id='L92'>
          <td class='lineno'>92</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    N::NTuple&#123;3, Int&#125;, L::NTuple&#123;3, T&#125;, k_x::Vector&#123;T&#125;, k_y::Vector&#123;T&#125;, </span>
          </td>
        </tr>
        <tr id='L93'>
          <td class='lineno'>93</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    phase_x::Vector&#123;Complex&#123;T&#125;&#125;, phase_y::Vector&#123;Complex&#123;T&#125;&#125;, </span>
          </td>
        </tr>
        <tr id='L94'>
          <td class='lineno'>94</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    r_z::Vector&#123;T&#125;, us_mat::Array&#123;Complex&#123;T&#125;, 3&#125;, uspara::USeriesPara&#123;T&#125;, M_mid::Int&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L95'>
          <td class='lineno'>95</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L96'>
          <td class='lineno'>96</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    set_zeros&#33;&#40;H_r&#41;</span>
          </td>
        </tr>
        <tr id='L97'>
          <td class='lineno'>97</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in 1:length&#40;qs&#41;</span>
          </td>
        </tr>
        <tr id='L98'>
          <td class='lineno'>98</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        interpolate_nu_loop_single&#33;&#40;H_r, qs&#91;i&#93;, poses&#91;i&#93;, N, L, k_x, k_y, phase_x, phase_y, r_z, us_mat, uspara, M_mid&#41;</span>
          </td>
        </tr>
        <tr id='L99'>
          <td class='lineno'>99</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L100'>
          <td class='lineno'>100</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L101'>
          <td class='lineno'>101</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return H_r</span>
          </td>
        </tr>
        <tr id='L102'>
          <td class='lineno'>102</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L103'>
          <td class='lineno'>103</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L104'>
          <td class='lineno'>104</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              23 &#40;0 &#37;&#41;
              samples spent in real2Cheb&#33;
              <br />
              
              23 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from energy_long_einsum
              <a href='energy_long.jl-7a7bb982ef2fa42807770cd492b7e09a2c3d1533.html#L57'>line 57</a>
              <br />
            </div>
            
            <span class='code'>@inbounds function real2Cheb&#33;&#40;H_r::Array&#123;Complex&#123;T&#125;, 3&#125;, H_c::Array&#123;Complex&#123;T&#125;, 3&#125;, r_z::Vector&#123;T&#125;, L_z::T&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L105'>
          <td class='lineno'>105</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L106'>
          <td class='lineno'>106</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='precompute.jl-6cd54421f03848108a172eb3577c601485e1022a.html#L4'>set_zeros&#33;</a>
              <br />
            </div>
            <span class='code'>    set_zeros&#33;&#40;H_c&#41;</span>
          </td>
        </tr>
        <tr id='L107'>
          <td class='lineno'>107</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    N_z &#61; size&#40;H_r, 3&#41;</span>
          </td>
        </tr>
        <tr id='L108'>
          <td class='lineno'>108</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L109'>
          <td class='lineno'>109</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for k in 1:N_z, l in 1:N_z</span>
          </td>
        </tr>
        <tr id='L110'>
          <td class='lineno'>110</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='precompute.jl-6cd54421f03848108a172eb3577c601485e1022a.html#L8'>chebpoly</a>
              <br />
            </div>
            <span class='code'>        cheb_temp &#61; chebpoly&#40;k - 1, r_z&#91;l&#93; - L_z / T&#40;2&#41;, L_z / T&#40;2&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L111'>
          <td class='lineno'>111</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        for j in 1:size&#40;H_r, 2&#41;, i in 1:size&#40;H_r, 1&#41;</span>
          </td>
        </tr>
        <tr id='L112'>
          <td class='lineno'>112</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>10 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              5 &#40;50 &#37;&#41;
              samples spent calling
              <a href='operators.jl-686c6e14b62f7e1edd63eed9861cf94955771a50.html#L587'>*</a>
              <br />
              4 &#40;40 &#37;&#41;
              samples spent calling
              <a href='complex.jl-758e93f59f1042cc0b16535ee36dbb19a5f5778f.html#L294'>&#43;</a>
              <br />
              1 &#40;10 &#37;&#41;
              samples spent calling
              <a href='array.jl-c942a1a6c0d71531a2d9e0c808522cde6be1c218.html#L1024'>setindex&#33;</a>
              <br />
            </div>
            <span class='code'>            H_c&#91;i, j, k&#93; &#43;&#61; 2 / N_z * H_r&#91;i, j, l&#93; * cheb_temp</span>
          </td>
        </tr>
        <tr id='L113'>
          <td class='lineno'>113</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>10 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              10 &#40;100 &#37;&#41;
              samples spent calling
              <a href='range.jl-98f40bce68f1934881ccb1db6e729761ce82d53a.html#L901'>iterate</a>
              <br />
            </div>
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L114'>
          <td class='lineno'>114</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L115'>
          <td class='lineno'>115</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L116'>
          <td class='lineno'>116</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return H_c</span>
          </td>
        </tr>
        <tr id='L117'>
          <td class='lineno'>117</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

