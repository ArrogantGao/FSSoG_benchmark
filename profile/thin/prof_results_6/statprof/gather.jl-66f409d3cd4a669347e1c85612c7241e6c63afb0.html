<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - ../../../.julia/packages/FastSpecSoG/pbwGj/src/FFCT/gather.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Sun, 14 Apr 2024 10:27:37
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@inbounds function gather_nu_single&#40;q::T, pos::NTuple&#123;3, T&#125;, L::NTuple&#123;3, T&#125;, k_x::Vector&#123;T&#125;, k_y::Vector&#123;T&#125;, phase_x::Vector&#123;Complex&#123;T&#125;&#125;, phase_y::Vector&#123;Complex&#123;T&#125;&#125;, H_c::Array&#123;Complex&#123;T&#125;, 3&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    x, y, z &#61; pos</span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    L_x, L_y, L_z &#61; L</span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ϕ &#61; zero&#40;Complex&#123;T&#125;&#41;</span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    revise_phase_pos&#33;&#40;phase_x, phase_y, k_x, k_y, x - T&#40;L&#91;1&#93; / 2&#41;, y - T&#40;L&#91;2&#93; / 2&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for k in 1:size&#40;H_c, 3&#41;</span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        cheb_val &#61; chebpoly&#40;k - 1, z - L_z / T&#40;2&#41;, L_z / T&#40;2&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        ϕ &#43;&#61; dot&#40;phase_x&#39;, &#40;@view H_c&#91;:, :, k&#93;&#41;, phase_y&#41;* cheb_val</span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return q * ϕ / &#40;2 * L_x * L_y&#41;</span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function gather_nu&#40;qs::Vector&#123;T&#125;, poses::Vector&#123;NTuple&#123;3, T&#125;&#125;, L::NTuple&#123;3, T&#125;, k_x::Vector&#123;T&#125;, k_y::Vector&#123;T&#125;, phase_x::Vector&#123;Complex&#123;T&#125;&#125;, phase_y::Vector&#123;Complex&#123;T&#125;&#125;, H_c::Array&#123;Complex&#123;T&#125;, 3&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    E &#61; zero&#40;Complex&#123;T&#125;&#41;</span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in 1:length&#40;qs&#41;</span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        E &#43;&#61; gather_nu_single&#40;qs&#91;i&#93;, poses&#91;i&#93;, L, k_x, k_y, phase_x, phase_y, H_c&#41;</span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return real&#40;E&#41;</span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L23'>
          <td class='lineno'>23</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L24'>
          <td class='lineno'>24</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              14391 &#40;27 &#37;&#41;
              samples spent in gather_thin_single
              <br />
              225 &#40;2 &#37;&#41; &#40;ex.&#41;,
              14391 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from gather_thin
              <a href='gather.jl-66f409d3cd4a669347e1c85612c7241e6c63afb0.html#L51'>line 51</a>
              <br />
            </div>
            
            <span class='code'>@inbounds function gather_thin_single&#40;q::T, pos::NTuple&#123;3, T&#125;, L_z::T, pad_grid::Array&#123;Complex&#123;T&#125;, 3&#125;, gridinfo::GridInfo&#123;2, T&#125;, cheb_value::Vector&#123;Array&#123;T, 1&#125;&#125;, cheb_coefs::NTuple&#123;2, ChebCoef&#123;T&#125;&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L25'>
          <td class='lineno'>25</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L26'>
          <td class='lineno'>26</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    potential_i &#61; zero&#40;T&#41;</span>
          </td>
        </tr>
        <tr id='L27'>
          <td class='lineno'>27</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    idl &#61; gridinfo.index_list</span>
          </td>
        </tr>
        <tr id='L28'>
          <td class='lineno'>28</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    x, y, z &#61; pos</span>
          </td>
        </tr>
        <tr id='L29'>
          <td class='lineno'>29</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L30'>
          <td class='lineno'>30</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>    near_id_image &#61; image_grid_id&#40;&#40;pos&#91;1&#93;, pos&#91;2&#93;&#41;, gridinfo&#41;</span>
          </td>
        </tr>
        <tr id='L31'>
          <td class='lineno'>31</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    near_pos_image &#61; image_grid_pos&#40;near_id_image, gridinfo&#41;</span>
          </td>
        </tr>
        <tr id='L32'>
          <td class='lineno'>32</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in 1:2</span>
          </td>
        </tr>
        <tr id='L33'>
          <td class='lineno'>33</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        dx &#61; pos&#91;i&#93; - near_pos_image&#91;i&#93;</span>
          </td>
        </tr>
        <tr id='L34'>
          <td class='lineno'>34</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>33 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              32 &#40;100 &#37;&#41;
              samples spent calling
              <a href='chebpoly.jl-8fee2fcfb3aacf810844bce32c46159bd024cc8c.html#L49'>pwcheb_eval&#33;</a>
              <br />
            </div>
            <span class='code'>        pwcheb_eval&#33;&#40;dx, cheb_value&#91;i&#93;, cheb_coefs&#91;i&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L35'>
          <td class='lineno'>35</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L36'>
          <td class='lineno'>36</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L37'>
          <td class='lineno'>37</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in gridinfo.iter_list</span>
          </td>
        </tr>
        <tr id='L38'>
          <td class='lineno'>38</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>50 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              50 &#40;100 &#37;&#41;
              samples spent calling
              <a href='broadcast.jl-1943ca80a8229cbeb9ec1bcdbc625cebe4309016.html#L903'>materialize</a>
              <br />
            </div>
            <span class='code'>        image_id &#61; near_id_image.id .&#43; i</span>
          </td>
        </tr>
        <tr id='L39'>
          <td class='lineno'>39</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        for k in 1:size&#40;pad_grid, 3&#41;</span>
          </td>
        </tr>
        <tr id='L40'>
          <td class='lineno'>40</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>11867 &#40;22 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              11867 &#40;100 &#37;&#41;
              samples spent calling
              <a href='Chebyshev.jl-f334a64fdf70fb79043072a128e7dbd1aafac6e6.html#L62'>chebpoly</a>
              <br />
            </div>
            <span class='code'>            cheb_val &#61; chebpoly&#40;k - 1, z - L_z / T&#40;2&#41;, L_z / T&#40;2&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L41'>
          <td class='lineno'>41</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2210 &#40;4 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1120 &#40;51 &#37;&#41;
              samples spent calling
              <a href='reduce.jl-c5ade0c5f9468e1857310eabdc7f023928ac02ae.html#L620'>prod</a>
              <br />
              557 &#40;25 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-91a35155f8b3385bc76887185f9af5c052bce2a9.html#L13'>getindex</a>
              <br />
              251 &#40;11 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-91a35155f8b3385bc76887185f9af5c052bce2a9.html#L14'>getindex</a>
              <br />
              187 &#40;8 &#37;&#41;
              samples spent calling
              <a href='float.jl-e6d486815d170ca14c7e10777bac9f9a694827df.html#L409'>&#43;</a>
              <br />
              81 &#40;4 &#37;&#41;
              samples spent calling
              <a href='operators.jl-685c570070943aa62c40697bdc9579c30a6c0a08.html#L587'>*</a>
              <br />
              14 &#40;1 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-91a35155f8b3385bc76887185f9af5c052bce2a9.html#L0'>getindex</a>
              <br />
            </div>
            <span class='code'>            potential_i &#43;&#61; real&#40;pad_grid&#91;idl&#91;1&#93;&#91;image_id&#91;1&#93;&#93;, idl&#91;2&#93;&#91;image_id&#91;2&#93;&#93;, k&#93;&#41; * prod&#40;cheb_value&#91;j&#93;&#91;i&#91;j&#93; &#43; gridinfo.w&#91;j&#93; &#43; 1&#93; for j in 1:2&#41; * cheb_val</span>
          </td>
        </tr>
        <tr id='L42'>
          <td class='lineno'>42</td>
          <td class='tracecount excl'>147 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>152 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              5 &#40;100 &#37;&#41;
              samples spent calling
              <a href='range.jl-16e9287909413222deea9e31d08ed76e4926c2e0.html#L901'>iterate</a>
              <br />
            </div>
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L43'>
          <td class='lineno'>43</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='iterators.jl-edb12bb6676f448ae8de0d966cb57cc343e6faa8.html#L1123'>iterate</a>
              <br />
            </div>
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L44'>
          <td class='lineno'>44</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L45'>
          <td class='lineno'>45</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return q * prod&#40;gridinfo.h&#41; * potential_i</span>
          </td>
        </tr>
        <tr id='L46'>
          <td class='lineno'>46</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L47'>
          <td class='lineno'>47</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L48'>
          <td class='lineno'>48</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function gather_thin&#40;qs::Vector&#123;T&#125;, poses::Vector&#123;NTuple&#123;3, T&#125;&#125;, L::NTuple&#123;3, T&#125;, H_c::Array&#123;Complex&#123;T&#125;, 3&#125;, gridinfo::GridInfo&#123;2, T&#125;, cheb_value::Vector&#123;Array&#123;T, 1&#125;&#125;, cheb_coefs::NTuple&#123;2, ChebCoef&#123;T&#125;&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L49'>
          <td class='lineno'>49</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    E &#61; zero&#40;Complex&#123;T&#125;&#41;</span>
          </td>
        </tr>
        <tr id='L50'>
          <td class='lineno'>50</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in 1:length&#40;qs&#41;</span>
          </td>
        </tr>
        <tr id='L51'>
          <td class='lineno'>51</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>15057 &#40;28 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              15057 &#40;28 &#37;&#41;
              samples spent in gather_thin
              <br />
              
              15057 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from energy_long_thin_k
              <a href='energy_long.jl-7c9458b48d9d2af327ddeddb0615fdfb4b52c110.html#L74'>line 74</a>
              <br />
            </div>
            <div class='callees'>
              14391 &#40;96 &#37;&#41;
              samples spent calling
              <a href='gather.jl-66f409d3cd4a669347e1c85612c7241e6c63afb0.html#L24'>gather_thin_single</a>
              <br />
              316 &#40;2 &#37;&#41;
              samples spent calling
              <a href='trig.jl-6cff8a73363f67b1be64f737e59929ac15cbd1ab.html#L98'>cos</a>
              <br />
              304 &#40;2 &#37;&#41;
              samples spent calling
              <a href='trig.jl-6cff8a73363f67b1be64f737e59929ac15cbd1ab.html#L671'>acos</a>
              <br />
              44 &#40;0 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-91a35155f8b3385bc76887185f9af5c052bce2a9.html#L24'>gather_thin_single</a>
              <br />
              2 &#40;0 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-91a35155f8b3385bc76887185f9af5c052bce2a9.html#L13'>getindex</a>
              <br />
            </div>
            <span class='code'>        E &#43;&#61; gather_thin_single&#40;qs&#91;i&#93;, poses&#91;i&#93;, L&#91;3&#93;, H_c, gridinfo, cheb_value, cheb_coefs&#41;</span>
          </td>
        </tr>
        <tr id='L52'>
          <td class='lineno'>52</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L53'>
          <td class='lineno'>53</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return real&#40;E&#41; / 2</span>
          </td>
        </tr>
        <tr id='L54'>
          <td class='lineno'>54</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

