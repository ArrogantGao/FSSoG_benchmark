<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - ../../../.julia/packages/FastSpecSoG/pbwGj/src/energy/energy_short.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Sun, 14 Apr 2024 10:22:36
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function F0_cal&#40;b::T, σ::T, ω::T, M::Int&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return - log&#40;b&#41; / sqrt&#40;2π&#41; / σ * &#40;ω &#43; &#40;one&#40;T&#41; - b^&#40;-M&#41;&#41; / &#40;b - one&#40;T&#41;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function F0_cal&#40;;preset::Int &#61; 1, T::DataType &#61; Float64&#41;</span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    @assert preset ≤ length&#40;preset_parameters&#41;</span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    b, σ, ω, M &#61; T&#40;preset_parameters&#91;preset&#93;&#91;1&#93;&#41;, T&#40;preset_parameters&#91;preset&#93;&#91;2&#93;&#41;, T&#40;preset_parameters&#91;preset&#93;&#91;3&#93;&#41;, Int&#40;preset_parameters&#91;preset&#93;&#91;4&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return F0_cal&#40;b, σ, ω, M&#41;</span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function Es_USeries_Cheb&#40;uspara::USeriesPara&#123;T&#125;, r_min::T, r_max::T, Q::Int&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    f &#61; r -&gt; U_series&#40;r, uspara&#41;</span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    x &#61; chebpoints&#40;Q, r_min, r_max&#41;</span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return chebinterp&#40;f.&#40;x&#41;, r_min, r_max&#41;</span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function Es_Cheb_precompute&#40;preset::Int, r_min::T, r_max::T, Q::Int&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    uspara &#61; USeriesPara&#40;preset, T&#41;</span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    uspara_cheb &#61; Es_USeries_Cheb&#40;uspara, r_min, r_max, Q&#41;</span>
          </td>
        </tr>
        <tr id='L23'>
          <td class='lineno'>23</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    F0 &#61; F0_cal&#40;preset &#61; preset, T &#61; T&#41;</span>
          </td>
        </tr>
        <tr id='L24'>
          <td class='lineno'>24</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return uspara_cheb, F0</span>
          </td>
        </tr>
        <tr id='L25'>
          <td class='lineno'>25</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L26'>
          <td class='lineno'>26</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L27'>
          <td class='lineno'>27</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function Es_self&#40;q::Vector&#123;T&#125;, F0::T&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L28'>
          <td class='lineno'>28</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L29'>
          <td class='lineno'>29</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Q &#61; sum&#40;qi^2 for qi in q&#41;</span>
          </td>
        </tr>
        <tr id='L30'>
          <td class='lineno'>30</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L31'>
          <td class='lineno'>31</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return Q * F0</span>
          </td>
        </tr>
        <tr id='L32'>
          <td class='lineno'>32</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L33'>
          <td class='lineno'>33</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L34'>
          <td class='lineno'>34</td>
          <td class='tracecount excl'>2 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>2 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              35 &#40;0 &#37;&#41;
              samples spent in Es_Cheb_pair
              <br />
              2 &#40;6 &#37;&#41; &#40;ex.&#41;,
              35 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from short_energy_Cheb
              <a href='energy_short.jl-9bbb39596405c2694365986da5005d2b748244a7.html#L50'>line 50</a>
              <br />
            </div>
            
            <span class='code'>function Es_Cheb_pair&#40;q_1::T, q_2::T, uspara_cheb::ChebPoly&#123;1, T, T&#125;, r::T&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L35'>
          <td class='lineno'>35</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>34 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              33 &#40;100 &#37;&#41;
              samples spent calling
              <a href='eval.jl-71f6a1eb0d7185cd91b4888229c8ff7e1f2f5e14.html#L70'>ChebPoly</a>
              <br />
            </div>
            <span class='code'>    return q_1 * q_2 * &#40;one&#40;T&#41; / r - uspara_cheb&#40;r&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L36'>
          <td class='lineno'>36</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L37'>
          <td class='lineno'>37</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L38'>
          <td class='lineno'>38</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              42 &#40;0 &#37;&#41;
              samples spent in short_energy_Cheb
              <br />
              2 &#40;5 &#37;&#41; &#40;ex.&#41;,
              42 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from energy_short
              <a href='energy_short.jl-9bbb39596405c2694365986da5005d2b748244a7.html#L64'>line 64</a>
              <br />
            </div>
            
            <span class='code'>function short_energy_Cheb&#40;uspara_cheb::ChebPoly&#123;1, T, T&#125;, r_c::T, F0::T, boundary::Boundary&#123;T&#125;, neighbor::CellList3D&#123;T&#125;, position::Vector&#123;NTuple&#123;3, T&#125;&#125;, q::Vector&#123;T&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L39'>
          <td class='lineno'>39</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    neighbor_list &#61; neighbor.neighbor_list</span>
          </td>
        </tr>
        <tr id='L40'>
          <td class='lineno'>40</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L41'>
          <td class='lineno'>41</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    energy_short &#61; zero&#40;T&#41;</span>
          </td>
        </tr>
        <tr id='L42'>
          <td class='lineno'>42</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L43'>
          <td class='lineno'>43</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for &#40;i, j, ρ&#41; in neighbor_list</span>
          </td>
        </tr>
        <tr id='L44'>
          <td class='lineno'>44</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>25 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              24 &#40;96 &#37;&#41;
              samples spent calling
              <a href='boundary.jl-2db46bdc32ca030a1edb28f6d9c7bbf3a569b5a3.html#L62'>position_check3D</a>
              <br />
              1 &#40;4 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-272a57e9ac3c19806e88e688cef454a91fa48b04.html#L13'>getindex</a>
              <br />
            </div>
            <span class='code'>        coord_1, coord_2, r_sq &#61; position_check3D&#40;position&#91;i&#93;, position&#91;j&#93;, boundary, r_c&#41;</span>
          </td>
        </tr>
        <tr id='L45'>
          <td class='lineno'>45</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        if iszero&#40;r_sq&#41;</span>
          </td>
        </tr>
        <tr id='L46'>
          <td class='lineno'>46</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            nothing</span>
          </td>
        </tr>
        <tr id='L47'>
          <td class='lineno'>47</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        else</span>
          </td>
        </tr>
        <tr id='L48'>
          <td class='lineno'>48</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            q_1 &#61; q&#91;i&#93;</span>
          </td>
        </tr>
        <tr id='L49'>
          <td class='lineno'>49</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            q_2 &#61; q&#91;j&#93;</span>
          </td>
        </tr>
        <tr id='L50'>
          <td class='lineno'>50</td>
          <td class='tracecount excl'>2 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>37 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              35 &#40;100 &#37;&#41;
              samples spent calling
              <a href='energy_short.jl-9bbb39596405c2694365986da5005d2b748244a7.html#L34'>Es_Cheb_pair</a>
              <br />
            </div>
            <span class='code'>            energy_short &#43;&#61; Es_Cheb_pair&#40;q_1, q_2, uspara_cheb, sqrt&#40;r_sq&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L51'>
          <td class='lineno'>51</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L52'>
          <td class='lineno'>52</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L53'>
          <td class='lineno'>53</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L54'>
          <td class='lineno'>54</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    energy_short &#43;&#61; Es_self&#40;q, F0&#41;</span>
          </td>
        </tr>
        <tr id='L55'>
          <td class='lineno'>55</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L56'>
          <td class='lineno'>56</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return energy_short / 4π</span>
          </td>
        </tr>
        <tr id='L57'>
          <td class='lineno'>57</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L58'>
          <td class='lineno'>58</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L59'>
          <td class='lineno'>59</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function energy_short&#40;interaction::FSSoGInteraction&#123;T&#125;, neighbor::CellList3D&#123;T&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L60'>
          <td class='lineno'>60</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return short_energy_Cheb&#40;interaction.uspara_cheb, interaction.r_c, interaction.F0, interaction.boundary, neighbor, interaction.position, interaction.charge&#41; / interaction.ϵ</span>
          </td>
        </tr>
        <tr id='L61'>
          <td class='lineno'>61</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L62'>
          <td class='lineno'>62</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L63'>
          <td class='lineno'>63</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function energy_short&#40;interaction::FSSoGThinInteraction&#123;T&#125;, neighbor::CellList3D&#123;T&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L64'>
          <td class='lineno'>64</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>42 &#40;0 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              42 &#40;0 &#37;&#41;
              samples spent in energy_short
              <br />
              
              42 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from energy
              <a href='energy.jl-226db030efae24f620dba53e8fe0895428e34c8f.html#L34'>line 34</a>
              <br />
            </div>
            <div class='callees'>
              42 &#40;100 &#37;&#41;
              samples spent calling
              <a href='energy_short.jl-9bbb39596405c2694365986da5005d2b748244a7.html#L38'>short_energy_Cheb</a>
              <br />
            </div>
            <span class='code'>    return short_energy_Cheb&#40;interaction.uspara_cheb, interaction.r_c, interaction.F0, interaction.boundary, neighbor, interaction.position, interaction.charge&#41; / interaction.ϵ</span>
          </td>
        </tr>
        <tr id='L65'>
          <td class='lineno'>65</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

