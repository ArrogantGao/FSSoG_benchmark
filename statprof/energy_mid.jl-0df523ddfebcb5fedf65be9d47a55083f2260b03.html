<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - ../../code/FastSpecSoG.jl/src/energy/energy_mid.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Tue, 20 Feb 2024 21:17:56
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function Tdk&#40;kx::T, ky::T, kz::T, uspara::USeriesPara&#123;T&#125;, M_mid::Int&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    k2 &#61; kx^2 &#43; ky^2 &#43; kz^2</span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Tdk_value &#61; zero&#40;T&#41;</span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in 1:M_mid</span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        sl, wl &#61; uspara.sw&#91;i&#93;</span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        Tdk_value &#43;&#61; wl * sl^3 * exp&#40;- sl^2 * k2 / 4&#41;</span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return sqrt&#40;π&#41;/4 * Tdk_value</span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function mid_paras_gen&#40;N_real::NTuple&#123;3, Int&#125;, w::NTuple&#123;3, Int&#125;, β::NTuple&#123;3, T&#125;, L::NTuple&#123;3, T&#125;, extra_pad_ratio::Int, cheb_order::Int, uspara::USeriesPara&#123;T&#125;, M_mid::Int&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    periodicity &#61; &#40;true, true, false&#41;</span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    extra_pad &#61; extra_pad_ratio .* w</span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    @assert M_mid &lt;&#61; length&#40;uspara.sw&#41;</span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    gridinfo &#61; GridInfo&#40;N_real, w, periodicity, extra_pad, L&#41;</span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    gridbox &#61; GridBox&#40;gridinfo&#41;</span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    f_window &#61; &#91;x -&gt; Wkb&#40;x, &#40;w&#91;i&#93; &#43; 0.5&#41; * gridinfo.h&#91;i&#93;, β&#91;i&#93;&#41; for i in 1:3&#93;</span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cheb_coefs &#61; tuple&#40;&#91;ChebCoef&#40;f_window&#91;i&#93;, gridinfo.h&#91;i&#93;, w&#91;i&#93;, cheb_order&#41; for i in 1:3&#93;...&#41;</span>
          </td>
        </tr>
        <tr id='L23'>
          <td class='lineno'>23</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L24'>
          <td class='lineno'>24</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    F_f_window &#61; &#91;x -&gt; FWkb&#40;x, &#40;w&#91;i&#93; &#43; 0.5&#41; * gridinfo.h&#91;i&#93;, β&#91;i&#93;&#41; for i in 1:3&#93;</span>
          </td>
        </tr>
        <tr id='L25'>
          <td class='lineno'>25</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L26'>
          <td class='lineno'>26</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    func_scale &#61; &#40;kx, ky, kz&#41; -&gt; &#40;F_f_window&#91;1&#93;&#40;kx&#41; * F_f_window&#91;2&#93;&#40;ky&#41; * F_f_window&#91;3&#93;&#40;kz&#41;&#41;^&#40;-2&#41; * Tdk&#40;kx, ky, kz, uspara, M_mid&#41;</span>
          </td>
        </tr>
        <tr id='L27'>
          <td class='lineno'>27</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    scalefactor &#61; ScalingFactor&#40;func_scale, gridinfo&#41;</span>
          </td>
        </tr>
        <tr id='L28'>
          <td class='lineno'>28</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L29'>
          <td class='lineno'>29</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return &#40;gridinfo, gridbox, cheb_coefs, scalefactor&#41;</span>
          </td>
        </tr>
        <tr id='L30'>
          <td class='lineno'>30</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L31'>
          <td class='lineno'>31</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L32'>
          <td class='lineno'>32</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              8417 &#40;100 &#37;&#41;
              samples spent in energy_mid
              <br />
              
              8417 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from macro expansion
              <a href='FFT3D_profile.jl-987d24a6f2832a5972976543b4fc1a739469c613.html#L26'>line 26</a>
              <br />
            </div>
            
            <span class='code'>function energy_mid&#40;qs::Vector&#123;T&#125;, poses::Vector&#123;NTuple&#123;3, T&#125;&#125;, gridinfo::GridInfo&#123;3, T&#125;, gridbox::GridBox&#123;3, T&#125;, cheb_coefs::NTuple&#123;3, ChebCoef&#123;T&#125;&#125;, scalefactor::ScalingFactor&#123;3, T&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L33'>
          <td class='lineno'>33</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L34'>
          <td class='lineno'>34</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>4481 &#40;53 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              4481 &#40;100 &#37;&#41;
              samples spent calling
              <a href='interpolate.jl-b0ec846d2cc71cdcaa9a085b8e2622a7d73b739d.html#L21'>interpolate&#33;</a>
              <br />
            </div>
            <span class='code'>    interpolate&#33;&#40;qs, poses, gridinfo, gridbox, cheb_coefs&#41;</span>
          </td>
        </tr>
        <tr id='L35'>
          <td class='lineno'>35</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>197 &#40;2 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              197 &#40;100 &#37;&#41;
              samples spent calling
              <a href='utils.jl-944a54d7ca2efcc117bb468cf75143cdaf697f2a.html#L21'>fft&#33;</a>
              <br />
            </div>
            <span class='code'>    fft&#33;&#40;gridbox&#41;</span>
          </td>
        </tr>
        <tr id='L36'>
          <td class='lineno'>36</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>12 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              12 &#40;100 &#37;&#41;
              samples spent calling
              <a href='scaling.jl-581bbcd9fe0c1e4256fcba3cdffbfa1a7da81914.html#L12'>scale&#33;</a>
              <br />
            </div>
            <span class='code'>    scale&#33;&#40;gridbox, scalefactor&#41;</span>
          </td>
        </tr>
        <tr id='L37'>
          <td class='lineno'>37</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>188 &#40;2 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              188 &#40;100 &#37;&#41;
              samples spent calling
              <a href='utils.jl-944a54d7ca2efcc117bb468cf75143cdaf697f2a.html#L33'>ifft&#33;</a>
              <br />
            </div>
            <span class='code'>    ifft&#33;&#40;gridbox&#41;</span>
          </td>
        </tr>
        <tr id='L38'>
          <td class='lineno'>38</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>3539 &#40;42 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              3538 &#40;100 &#37;&#41;
              samples spent calling
              <a href='gather.jl-a7b0b3021f619af8d94c9ed443c525d43f363015.html#L23'>gather</a>
              <br />
              1 &#40;0 &#37;&#41;
              samples spent calling
              <a href='gather.jl-a7b0b3021f619af8d94c9ed443c525d43f363015.html#L1'>gather_single</a>
              <br />
            </div>
            <span class='code'>    E &#61; gather&#40;qs, poses, gridinfo, gridbox, cheb_coefs&#41; / 2</span>
          </td>
        </tr>
        <tr id='L39'>
          <td class='lineno'>39</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L40'>
          <td class='lineno'>40</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return E</span>
          </td>
        </tr>
        <tr id='L41'>
          <td class='lineno'>41</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

