<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - ../../code/FastSpecSoG.jl/src/FFCT/nugrid_gather.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Tue, 20 Feb 2024 20:23:27
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              2338 &#40;35 &#37;&#41;
              samples spent in gather_nu_single
              <br />
              6 &#40;0 &#37;&#41; &#40;ex.&#41;,
              2337 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from gather_nu
              <a href='nugrid_gather.jl-9af5c28b9ab671a3d74a275b89e90f192426d884.html#L19'>line 19</a>
              <br />
              1 &#40;0 &#37;&#41; &#40;ex.&#41;,
              1 &#40;0 &#37;&#41; &#40;incl.&#41;
              when called from macro expansion
              <a href='interpolate_nu.jl-ff4b72ca0f2dad80965fb35c48c9714f3c0eebb8.html#L21'>line 21</a>
              <br />
            </div>
            
            <span class='code'>@inbounds function gather_nu_single&#40;q::T, pos::NTuple&#123;3, T&#125;, L::NTuple&#123;3, T&#125;, k_x::Vector&#123;T&#125;, k_y::Vector&#123;T&#125;, phase_x::Vector&#123;Complex&#123;T&#125;&#125;, phase_y::Vector&#123;Complex&#123;T&#125;&#125;, H_s::Array&#123;Complex&#123;T&#125;, 3&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    x, y, z &#61; pos</span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    L_x, L_y, L_z &#61; L</span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ϕ &#61; zero&#40;Complex&#123;T&#125;&#41;</span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>362 &#40;5 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              361 &#40;100 &#37;&#41;
              samples spent calling
              <a href='precompute.jl-3364aac514816cfcd59ddb70253e78a8e08b3c80.html#L79'>revise_phase_pos&#33;</a>
              <br />
              1 &#40;0 &#37;&#41;
              samples spent calling
              <a href='exp.jl-ac5db3c00ad4c8c72092449f68ba0757ce6b8885.html#L327'>exp</a>
              <br />
            </div>
            <span class='code'>    revise_phase_pos&#33;&#40;phase_x, phase_y, k_x, k_y, x, y&#41;</span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for k in 1:size&#40;H_s, 3&#41;</span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>170 &#40;3 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              169 &#40;99 &#37;&#41;
              samples spent calling
              <a href='precompute.jl-3364aac514816cfcd59ddb70253e78a8e08b3c80.html#L8'>chebpoly</a>
              <br />
              1 &#40;1 &#37;&#41;
              samples spent calling
              <a href='int.jl-7f9f75a92d8c6f74216e9bbdc4b48345bf2279eb.html#L86'>-</a>
              <br />
            </div>
            <span class='code'>        cheb_val &#61; k &#61;&#61; 1 ? T&#40;0.5&#41; : chebpoly&#40;k - 1, z - L_z / T&#40;2&#41;, L_z / T&#40;2&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'>2 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1801 &#40;27 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1742 &#40;97 &#37;&#41;
              samples spent calling
              <a href='generic.jl-802730dc204098d7927d2910045227681dd71976.html#L923'>dot</a>
              <br />
              52 &#40;3 &#37;&#41;
              samples spent calling
              <a href='complex.jl-c34ddccfd71fd59e2d6042f2ac058720eb510edf.html#L294'>&#43;</a>
              <br />
              5 &#40;0 &#37;&#41;
              samples spent calling
              <a href='complex.jl-c34ddccfd71fd59e2d6042f2ac058720eb510edf.html#L340'>*</a>
              <br />
            </div>
            <span class='code'>        ϕ &#43;&#61; dot&#40;phase_x, &#40;@view H_s&#91;:, :, k&#93;&#41;, phase_y&#41;* cheb_val</span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'>4 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>4 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>    return q * ϕ / &#40;2 * L_x * L_y&#41;</span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function gather_nu&#40;qs::Vector&#123;T&#125;, poses::Vector&#123;NTuple&#123;3, T&#125;&#125;, L::NTuple&#123;3, T&#125;, k_x::Vector&#123;T&#125;, k_y::Vector&#123;T&#125;, phase_x::Vector&#123;Complex&#123;T&#125;&#125;, phase_y::Vector&#123;Complex&#123;T&#125;&#125;, H_s::Array&#123;Complex&#123;T&#125;, 3&#125;&#41; where&#123;T&#125;</span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    E &#61; zero&#40;Complex&#123;T&#125;&#41;</span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in 1:length&#40;qs&#41;</span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2350 &#40;35 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              2350 &#40;35 &#37;&#41;
              samples spent in gather_nu
              <br />
              
              2350 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from energy_long_einsum
              <a href='energy_long.jl-11fdf3b78c8961cf3315c095b6968a23d800698e.html#L59'>line 59</a>
              <br />
            </div>
            <div class='callees'>
              2337 &#40;99 &#37;&#41;
              samples spent calling
              <a href='nugrid_gather.jl-9af5c28b9ab671a3d74a275b89e90f192426d884.html#L1'>gather_nu_single</a>
              <br />
              5 &#40;0 &#37;&#41;
              samples spent calling
              <a href='complex.jl-c34ddccfd71fd59e2d6042f2ac058720eb510edf.html#L294'>&#43;</a>
              <br />
              4 &#40;0 &#37;&#41;
              samples spent calling
              <a href='essentials.jl-dca5ff521169103b2c0df51fc60a4cb8f8d56231.html#L13'>getindex</a>
              <br />
              2 &#40;0 &#37;&#41;
              samples spent calling
              <a href='precompute.jl-3364aac514816cfcd59ddb70253e78a8e08b3c80.html#L79'>revise_phase_pos&#33;</a>
              <br />
              2 &#40;0 &#37;&#41;
              samples spent calling
              <a href='generic.jl-802730dc204098d7927d2910045227681dd71976.html#L923'>dot</a>
              <br />
            </div>
            <span class='code'>        E &#43;&#61; gather_nu_single&#40;qs&#91;i&#93;, poses&#91;i&#93;, L, k_x, k_y, phase_x, phase_y, H_s&#41;</span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return real&#40;E&#41;</span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

